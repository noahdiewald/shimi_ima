/*! Dictionary Maker - v0.1.0 - 2013-09-26
* http://ling.wisc.edu/
* Copyright (c) 2013 UW Madison Board of Regents; Licensed GNU GPLv3 */

var globals={};require=function e(t,n,i){function s(a,o){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!o&&c)return c(a,!0);if(r)return r(a,!0);throw Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return s(n?n:e)},u,u.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;i.length>a;a++)s(i[a]);return s}({1:[function(e,t,n){(function(e){function t(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function n(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function i(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var i=1,s=e.length;s>i;i++)if(t.charAt(n+i)!=e.charAt(i))return!1;return!0}function s(e,t,n,i){for(var o=[],c=null,u=null;e.length>0;)if(u=e.shift(),"#"==u.tag||"^"==u.tag||r(u,i))n.push(u),u.nodes=s(e,u.tag,n,i),o.push(u);else{if("/"==u.tag){if(0===n.length)throw Error("Closing tag without opener: /"+u.n);if(c=n.pop(),u.n!=c.n&&!a(u.n,c.n,i))throw Error("Nesting error: "+c.n+" vs. "+u.n);return c.end=u.i,o}o.push(u)}if(n.length>0)throw Error("missing closing tag: "+n.pop().n);return o}function r(e,t){for(var n=0,i=t.length;i>n;n++)if(t[n].o==e.n)return e.tag="#",!0}function a(e,t,n){for(var i=0,s=n.length;s>i;i++)if(n[i].c==e&&n[i].o==t)return!0}function o(e){return e.replace(j,"\\\\").replace(m,'\\"').replace(g,"\\n").replace(y,"\\r")}function c(e){return~e.indexOf(".")?"d":"f"}function u(e){for(var t="",n=0,i=e.length;i>n;n++){var s=e[n].tag;"#"==s?t+=l(e[n].nodes,e[n].n,c(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag):"^"==s?t+=d(e[n].nodes,e[n].n,c(e[n].n)):"<"==s||">"==s?t+=f(e[n]):"{"==s||"&"==s?t+=b(e[n].n,c(e[n].n)):"\n"==s?t+=h('"\\n"'+(e.length-1==n?"":" + i")):"_v"==s?t+=p(e[n].n,c(e[n].n)):void 0===s&&(t+=h('"'+o(e[n])+'"'))}return t}function l(e,t,n,i,s,r){return"if(_.s(_."+n+'("'+o(t)+'",c,p,1),'+"c,p,0,"+i+","+s+',"'+r+'")){'+"_.rs(c,p,"+"function(c,p,_){"+u(e)+"});c.pop();}"}function d(e,t,n){return"if(!_.s(_."+n+'("'+o(t)+'",c,p,1),c,p,1,0,0,"")){'+u(e)+"};"}function f(e){return'_.b(_.rp("'+o(e.n)+'",c,p,"'+(e.indent||"")+'"));'}function b(e,t){return"_.b(_.t(_."+t+'("'+o(e)+'",c,p,0)));'}function p(e,t){return"_.b(_.v(_."+t+'("'+o(e)+'",c,p,0)));'}function h(e){return"_.b("+e+");"}var v=/\S/,m=/\"/g,g=/\n/g,y=/\r/g,j=/\\/g,w={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};e.scan=function(e,s){function r(){m.length>0&&(g.push(new String(m)),m="")}function a(){for(var e=!0,t=$;g.length>t;t++)if(e=g[t].tag&&w[g[t].tag]<w._v||!g[t].tag&&null===g[t].match(v),!e)return!1;return e}function o(e,t){if(r(),e&&a())for(var n,i=$;g.length>i;i++)g[i].tag||((n=g[i+1])&&">"==n.tag&&(n.indent=""+g[i]),g.splice(i,1));else t||g.push({tag:"\n"});y=!1,$=g.length}function c(e,t){var i="="+k,s=e.indexOf(i,t),r=n(e.substring(e.indexOf("=",t)+1,s)).split(" ");return x=r[0],k=r[1],s+i.length-1}var u=e.length,l=0,d=1,f=2,b=l,p=null,h=null,m="",g=[],y=!1,j=0,$=0,x="{{",k="}}";for(s&&(s=s.split(" "),x=s[0],k=s[1]),j=0;u>j;j++)b==l?i(x,e,j)?(--j,r(),b=d):"\n"==e.charAt(j)?o(y):m+=e.charAt(j):b==d?(j+=x.length-1,h=w[e.charAt(j+1)],p=h?e.charAt(j+1):"_v","="==p?(j=c(e,j),b=l):(h&&j++,b=f),y=j):i(k,e,j)?(g.push({tag:p,n:n(m),otag:x,ctag:k,i:"/"==p?y-k.length:j+x.length}),m="",j+=k.length-1,b=l,"{"==p&&("}}"==k?j++:t(g[g.length-1]))):m+=e.charAt(j);return o(y,!0),g},e.generate=function(t,n,i){var s='var _=this;_.b(i=i||"");'+u(t)+"return _.fl();";return i.asString?"function(c,p,i){"+s+";}":new e.Template(Function("c","p","i",s),n,e,i)},e.parse=function(e,t,n){return n=n||{},s(e,"",[],n.sectionTags||[])},e.cache={},e.compile=function(e,t){t=t||{};var n=e+"||"+!!t.asString,i=this.cache[n];return i?i:(i=this.generate(this.parse(this.scan(e,t.delimiters),e,t),e,t),this.cache[n]=i)}})(n!==void 0?n:Hogan)},{}],2:[function(e,t){var n=e("./compiler");n.Template=e("./template").Template,t.exports=n},{"./compiler":1,"./template":3}],3:[function(e,t,n){var i={};(function(e,t){function n(e){return(null===e||void 0===e?"":e)+""}function i(e){return e=n(e),u.test(e)?e.replace(s,"&amp;").replace(r,"&lt;").replace(a,"&gt;").replace(o,"&#39;").replace(c,"&quot;"):e}e.Template=function(e,n,i,s){this.r=e||this.r,this.c=i,this.options=s,this.text=n||"",this.buf=t?[]:""},e.Template.prototype={r:function(){return""},v:i,t:n,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,i){var s=n[e];return s?(this.c&&"string"==typeof s&&(s=this.c.compile(s,this.options)),s.ri(t,n,i)):""},rs:function(e,t,n){var i=e[e.length-1];if(!l(i))return n(e,t,this),void 0;for(var s=0;i.length>s;s++)e.push(i[s]),n(e,t,this),e.pop()},s:function(e,t,n,i,s,r,a){var o;return l(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ls(e,t,n,i,s,r,a)),o=""===e||!!e,!i&&o&&t&&t.push("object"==typeof e?e:t[t.length-1]),o)},d:function(e,t,n,i){var s=e.split("."),r=this.f(s[0],t,n,i),a=null;if("."===e&&l(t[t.length-2]))return t[t.length-1];for(var o=1;s.length>o;o++)r&&"object"==typeof r&&s[o]in r?(a=r,r=r[s[o]]):r="";return i&&!r?!1:(i||"function"!=typeof r||(t.push(a),r=this.lv(r,t,n),t.pop()),r)},f:function(e,t,n,i){for(var s=!1,r=null,a=!1,o=t.length-1;o>=0;o--)if(r=t[o],r&&"object"==typeof r&&e in r){s=r[e],a=!0;break}return a?(i||"function"!=typeof s||(s=this.lv(s,t,n)),s):i?!1:""},ho:function(e,t,n,i,s){var r=this.c,a=this.options;a.delimiters=s;var i=e.call(t,i);return i=null==i?i+"":""+i,this.b(r.compile(i,a).render(t,n)),!1},b:t?function(e){this.buf.push(e)}:function(e){this.buf+=e},fl:t?function(){var e=this.buf.join("");return this.buf=[],e}:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,n,i,s,r,a){var o=t[t.length-1],c=null;if(!i&&this.c&&e.length>0)return this.ho(e,o,n,this.text.substring(s,r),a);if(c=e.call(o),"function"==typeof c){if(i)return!0;if(this.c)return this.ho(c,o,n,this.text.substring(s,r),a)}return c},lv:function(e,t,i){var s=t[t.length-1],r=e.call(s);return"function"==typeof r&&(r=n(r.call(s)),this.c&&~r.indexOf("{{"))?this.c.compile(r,this.options).render(s,i):n(r)}};var s=/&/g,r=/</g,a=/>/g,o=/\'/g,c=/\"/g,u=/[&<>\"\']/,l=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}})(n!==void 0?n:i)},{}],4:[function(e,t){t.exports,e("./jquery-ui-input-state.js");var n=e("./click-dispatch.js").clickDispatch,i=e("./dblclick-dispatch.js").dblclickDispatch,s=e("./changes.js").changes,r=e("./keystrokes.js").keystrokes,a=e("./form.js"),o=e("./documents/documents.js"),c=e("./file_manager/fm.js"),u=e("./index_tool/ilistingui.js"),l=e("./projects/projectui.js"),d=e("./config/config.js");String.prototype.isBlank=function(){"use strict";return/^\s*$/.test(this)&&!/\S/.test(this)},String.prototype.trim=function(){"use strict";return this.replace(/^\s+/,"").replace(/\s+$/,"")},Array.prototype.trimAll=function(){"use strict";return this.map(function(e){return e.trim()}).filter(function(e){return!e.match(/^$/)})},$(function(){"use strict";$("body").click(function(e){n(e)}),$("body").dblclick(function(e){i(e)}),r(),s(),$(".notification").hide(),$("#loading").hide(),$(document).ajaxStart(function(){$("#loading").show()}).ajaxStop(function(){$("#loading").hide()}),a.initDateFields(),$("#all-config-container").length>0&&d.init(),$("#all-document-container").length>0&&o.init(),$("#file-upload").length>0&&c.init(),$("#all-index-container").length>0&&u.init(),$("#projects-container").length>0&&l.init()})},{"./changes.js":5,"./click-dispatch.js":6,"./config/config.js":11,"./dblclick-dispatch.js":21,"./documents/documents.js":25,"./file_manager/fm.js":33,"./form.js":35,"./index_tool/ilistingui.js":42,"./jquery-ui-input-state.js":46,"./keystrokes.js":48,"./projects/projectui.js":52}],5:[function(e,t,n){var i=e("./documents/searchui.js"),s=function(){"use strict";$(document).on("change","#document-search-exclude",function(){return i.toggleExclusion(),!0}),$(document).on("change","#document-search-invert",function(){return i.toggleInversion(),!0})};n.changes=s},{"./documents/searchui.js":29}],6:[function(e,t,n){var i=e("./sender.js"),s=e("./dispatcher.js").dispatcher,r=e("./panel-toggle.js").panelToggler,a=e("./documents/editui.js"),o=e("./documents/viewui.js"),c=e("./documents/indexui.js"),u=e("./documents/setsui.js"),l=e("./documents/searchui.js"),d=e("./documents/worksheetui.js"),f=e("./documents/fieldsets.js"),b=e("./index_tool/ieditui.js"),p=e("./form.js"),h=e("./projects/projectui.js"),v=e("./file_manager/fm.js"),m=e("./config/maintenanceui.js"),g=e("./config/doctype-tab.js"),y=e("./config/charseq-tab").charseqTab,j=function(e){"use strict";var t=s({".edit-field-button":function(e){g.editField(e)},".delete-field-button":function(e){g.deleteField(e)},".add-field-button":function(e){g.addField(e)},".edit-fieldset-button":function(e){g.editFieldset(e)},".delete-fieldset-button":function(e){g.deleteFieldset(e)},".add-fieldset-button":function(e){g.addFieldset(e)},".delete-doctype-button":function(e){g.deleteDoctype(e)},".edit-doctype-button":function(e){g.editDoctype(e)},".touch-doctype-button":function(e){g.touchDoctype(e)},"#doctype-add-button":function(e){g.addDoctype(e)},".delete-charseq-button":function(e){y.del(e)},".edit-charseq-button":function(e){y.edit(e)},"#charseq-add-button":function(){y.add()},"#maintenance-upgrade-button":function(e){m.upgradeButton(e)},".add-button":function(e){f.initFieldset(e,!1,!0)},".remove-button":function(e){f.removeFieldset(e)},"#save-document-button":function(){a.save()},"#create-document-button":function(){a.create()},"#clear-document-button":function(){a.clear()},".expander":function(e){a.toggleTextarea(e)},"label span.ui-icon-help":function(e){a.showHelpDialog(e)},"#document-edit-button":function(e){o.edit(e)},"#document-delete-button":function(){o.confirmDelete()},"#document-restore-button":function(){o.confirmRestore()},"#document-view-tree > ul > li > b":function(e){o.collapseToggle(e)},".revision-link":function(e){o.fetchRevision(e)},"#search-all-fields-switch a":function(){l.allFields()},".search-field-item":function(e){l.removeField(e)},".select-results":function(e){l.toggleSelection(e)},"#save-search-results a":function(){$("#new-set-target-input").val("search"),$("#new-set-dialog").show()},"#save-set-results a":function(){$("#new-set-target-input").val("sets"),$("#new-set-dialog").show()},"#new-set-save-button":function(){i.sender("new-set-form-submit")},"#select-all-set-elements":function(e){u.toggleSelectAll(e)},".view-document-link span":function(e){var t=e[0].parentNode;c.load(t)},".view-document-link":function(e){c.load(e)},".select-worksheet-column":function(e){var t=$(e),n=t.is(":checked"),i=t.attr("data-field-field");d.columnSelection(i,n)},".select-worksheet-row":function(e){var t=$(e),n=t.is(":checked"),i=t.attr("data-row");d.rowSelection(i,n)},"#select-all-worksheet-rows":function(e){var t=$(e).is(":checked");d.selectAllRows(t)},"#toggle-handles":function(){d.showHandles()},".fieldset-handle":function(e){d.showFieldset($(e).attr("data-field-fieldset"))},".field-handle":function(e){d.showField($(e).attr("data-field-field"))},".field-header":function(e){d.hideField($(e).attr("data-field-field"))},"#new-index-button":function(){b.newCond()},".remove-condition-button":function(e){b.remCond(e)},"#delete-index-button":function(){b.del()},"#save-index-button":function(){b.save()},"#replace-button":function(){b.replace()},"#add-index-condition-button":function(){b.addCond()},"#index-index-listing a":function(e){b.init(e)},"#create-project":function(){h.add().dialog("open")},".project-delete-button":function(e){h.del(e)},"#up-dir":function(){v.upDir()},"#root-dir":function(){v.rootDir()},".dir":function(e){v.goDir(e)},".delete-file-button":function(e){v.deleteFile(e)},".edit-file-button":function(e){v.editFile(e)},".toggler":function(e){p.toggle(e)},".cancel-dialog":function(e){p.cancelDialog(e)},"#panel-toggle li":function(e){r(e)}});t(e)};n.clickDispatch=j},{"./config/charseq-tab":9,"./config/doctype-tab.js":14,"./config/maintenanceui.js":20,"./dispatcher.js":22,"./documents/editui.js":26,"./documents/fieldsets.js":27,"./documents/indexui.js":28,"./documents/searchui.js":29,"./documents/setsui.js":30,"./documents/viewui.js":31,"./documents/worksheetui.js":32,"./file_manager/fm.js":33,"./form.js":35,"./index_tool/ieditui.js":39,"./panel-toggle.js":50,"./projects/projectui.js":52,"./sender.js":55}],7:[function(e,t,n){var i=e("./charseq-elems.js").charseqElems,s=e("./charseq-tab.js").charseqTab,r=e("../form.js"),a=function(e){"use strict";var t=i.get(e),n=$("#charseq-dialog").dialog({width:650,autoOpen:!1,modal:!0,buttons:{Save:function(){var n=t.getCharseqInputVals(),i="config/charseqs",a="POST",o=function(e){s.init(),$(e).dialog("close")};e&&e.rev&&(a="PUT",i="config/charseqs/"+n._id+"?rev="+n.rev),r.send(i,n,a,o,this)},Cancel:function(){$(this).dialog("close")}},close:function(){t.clear()}});return n};n.charseqDialog=a},{"../form.js":35,"./charseq-elems.js":8,"./charseq-tab.js":9}],8:[function(e,t,n){var i=e("../form.js"),s=function(){"use strict";var e={};return e.attrs=["description","characters","name","sort_ignore","locale","tailoring","vowels","consonants","ietf_tag","iso639_tag","charseq","rev"],e.get=function(t){var n={};return n.attrs=e.attrs,n.copyValues=function(e){return Object.keys(e).forEach(function(t){n[t].val(e[t])}),n},n.getCharseqInputVals=function(){var e={category:"charseq",description:n.description.val(),characters:n.parse(n.characters.val()),name:n.name.val(),sort_ignore:n.parse(n.sort_ignore.val()),locale:n.locale.val(),tailoring:n.tailoring.val(),vowels:n.parse(n.vowels.val()),consonants:n.parse(n.consonants.val()),ietf_tag:n.ietf_tag.val(),iso639_tag:n.iso639_tag.val(),_id:n.charseq.val()||void 0,rev:n.rev.val()||void 0};return e},n.parse=function(e){return e&&!e.isBlank()?JSON.parse(e):[]},n.clear=function(){return i.clear($("#charseq-dialog .input")).removeClass("ui-state-error"),n},n.attrs.forEach(function(e){n[e]=$("#charseq-"+e+"-input")}),t&&n.copyValues(t),n},e}();n.charseqElems=s},{"../form.js":35}],9:[function(e,t,n){var i=e("./charseq-dialog.js").charseqDialog,s=e("./charseq-elems.js").charseqElems,r=e("../store.js").store,a=e("../form.js"),o=function(){"use strict";var e={};return e.add=function(){return i().dialog("open"),e},e.edit=function(t){var n={},a=s.attrs;return a.forEach(function(e){n[e]=r(t).get64("charseq-"+e)}),i(n).dialog("open"),e},e.del=function(t){var n=r(t),i=n.get("charseq-charseq"),s=n.get("charseq-rev"),o="config/charseqs/"+i+"?rev="+s,c=function(){e.init()};return window.confirm("Are you sure? This is permanent.")&&a.send(o,{},"DELETE",c,this),e},e.init=function(){var t=$("#charseq-tabs"),n=$("#charseq-tabs-headings"),i="config/charseqs";return t.tabs(),$.get(i,function(e){n.empty(),n.find(".ui-tabs-panel").remove(),t.tabs("destroy"),n.html(e),t.tabs()}),e},e}();n.charseqTab=o},{"../form.js":35,"../store.js":58,"./charseq-dialog.js":7,"./charseq-elems.js":8}],10:[function(e,t,n){e("templates.js");var i=e("../pager.js").pager,s=function(){"use strict";return"charseqs"},r=function(){"use strict";var e="config/"+s(),t=document.getElementById(s()+"-listing");return i({prefix:s(),url:e,target:t}).get(),"charseq-listing-requested"},a=function(){"use strict";return r(),"charsequi-initialized"};n.init=a,n.get=r,n.prefix=s},{"../pager.js":49,"templates.js":"e8H8MT"}],11:[function(e,t,n){var i=e("./doctypeui.js"),s=e("./maintenanceui.js"),r=e("./charsequi.js"),a=function(){"use strict";return i.init(),r.init(),s.init(),"config-initialized"};n.init=a},{"./charsequi.js":10,"./doctypeui.js":15,"./maintenanceui.js":20}],12:[function(e,t,n){var i=e("./doctype-elems.js").doctypeElems,s=e("./doctype-tab.js"),r=function(e,t){"use strict";var n=i.get(t);t.rev&&!t.rev.isBlank()?n.doctype.attr("disabled","disabled"):n.doctype.removeAttr("disabled");var r=$("#doctype-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Save:function(){var i=n.getDoctypeInputVals(),r=function(e){s.init(),$(e).dialog("close")};!t.rev||t.rev.isBlank()?e.post(i,r,this):(i._id=e.doctype,e.put(i,r,this))},Cancel:function(){$(this).dialog("close")}},close:function(){n.clear()}});return r};n.doctypeDialog=r},{"./doctype-elems.js":13,"./doctype-tab.js":14}],13:[function(e,t,n){var i=e("../form.js"),s=function(){"use strict";var e={};return e.attrs=["description","doctype","rev"],e.get=function(t){var n={};return n.copyValues=function(e){return Object.keys(e).forEach(function(t){n[t].val(e[t])}),n},n.getDoctypeInputVals=function(){var e={category:"doctype",description:n.description.val(),_id:n.doctype.val()};return e},n.clear=function(){return i.clear($("#doctype-dialog .input")).removeClass("ui-state-error"),n},e.attrs.forEach(function(e){n[e]=$("#doctype-"+e+"-input")}),n.copyValues(t),n},e}();n.doctypeElems=s},{"../form.js":35}],14:[function(e,t,n){var i=e("./doctype-dialog.js").doctypeDialog,s=e("./doctype-elems.js").doctypeElems,r=e("./field-dialog.js").fieldDialog,a=e("./field-elems.js").fieldElems,o=e("./fieldset-dialog.js").fieldsetDialog,c=e("./fieldset-elems.js").fieldsetElems,u=e("../store.js").store,l=e("../path.js").path,d=function(e,t){"use strict";return l(e,t,"config")},f=function(e){"use strict";return e.field=!1,$.get(""+e,function(t){var n=$("#fields-"+e.fieldset);n.empty(),n.html(t)}),!0},b=function(e){"use strict";$.get(""+e,function(t){var n=$("#fieldsets-"+e.doctype);n.empty(),n.accordion(),n.accordion("destroy"),n.html(t),n.accordion({autoHeight:!1,collapsible:!0,active:!1})})},p=function(){"use strict";var e="config/doctypes";$("#doctype-tabs").tabs(),$.get(e,function(e){$("#fieldset-doctype-input"),$("#doctype-tabs-headings").empty(),$("#doctype-tabs-headings + .ui-tabs-panel").remove(),$("#doctype-tabs").tabs("destroy"),$("#doctype-tabs-headings").html(e);var t=function(e,t){var n=$(t.panel).children("div[data-fieldset-doctype]"),i=l(n,"fieldset","config");b(i)};$("#doctype-tabs").tabs({load:function(e,n){t(e,n)}})})},h=function(e){"use strict";var t=d(e,"field"),n={},i=a.attrs,s="config/charseqs?as=options";$.get(s,function(s){$("#field-charseq-input").html(s),i.forEach(function(t){n[t]=u(e).get("field-"+t)}),r(t,n).dialog("open")})},v=function(e){"use strict";var t=window.confirm("Are you sure? This is permanent.");if(t){var n=d(e,"field"),i=function(){n.field=!1,n.rev=!1,f(n)};n.del(i,this)}},m=function(e){"use strict";var t=d(e,"field"),n="config/charseqs?as=options";$.get(n,function(e){$("#field-charseq-input").html(e),r(t,{fieldset:t.fieldset,doctype:t.doctype}).dialog("open")})},g=function(e){"use strict";var t=d(e,"fieldset"),n={},i=c.attrs;i.forEach(function(t){n[t]=u(e).get("fieldset-"+t)}),o(t,n).dialog("open")},y=function(e){"use strict";var t=d(e,"fieldset"),n=function(){t.fieldset=!1,t.rev=!1,b(t)};window.confirm("Are you sure? This is permanent.")&&t.del(n,this)},j=function(e){"use strict";var t=d(e,"fieldset");o(t,{doctype:t.doctype}).dialog("open")},w=function(e){"use strict";var t=d(e,"doctype"),n={},r=s.attrs;r.forEach(function(t){n[t]=u(e).get("doctype-"+t)}),i(t,n).dialog("open")},x=function(e){"use strict";var t=u(e).get("doctype-doctype");$.post("config/doctypes/"+t+"/touch"),window.alert("Touch In Progress")},k=function(e){"use strict";var t=d(e,"doctype"),n=function(){t.doctype=!1,t.rev=!1,p()};window.confirm("Are you sure? This is permanent.")&&t.del(n,this)},_=function(e){"use strict";var t=d(e,"doctype");i(t,{}).dialog("open")};n.initFields=f,n.initFieldsets=b,n.init=p,n.editField=h,n.deleteField=v,n.addField=m,n.editFieldset=g,n.deleteFieldset=y,n.addFieldset=j,n.editDoctype=w,n.touchDoctype=x,n.deleteDoctype=k,n.addDoctype=_},{"../path.js":51,"../store.js":58,"./doctype-dialog.js":12,"./doctype-elems.js":13,"./field-dialog.js":16,"./field-elems.js":17,"./fieldset-dialog.js":18,"./fieldset-elems.js":19}],15:[function(e,t,n){e("templates.js");var i=e("../pager.js").pager,s=function(){"use strict";return"doctypes"},r=function(){"use strict";var e="config/"+s(),t=document.getElementById(s()+"-listing");return i({prefix:s(),url:e,target:t}).get(),"doctype-listing-requested"},a=function(){"use strict";return r(),"doctypeui-initialized"};n.init=a,n.get=r,n.prefix=s},{"../pager.js":49,"templates.js":"e8H8MT"}],16:[function(e,t,n){var i=e("./field-elems.js").fieldElems,s=e("./doctype-tab.js"),r=function(e,t){"use strict";var n=i.get(t),r=$("#field-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Save:function(){var i=n.clearDisabled().getFieldInputVals(),r=function(t){s.initFields(e),$(t).dialog("close")};!t.rev||t.rev.isBlank()?e.post(i,r,this):(i._id=e.field,e.put(i,r,this))},Cancel:function(){$(this).dialog("close")}},close:function(){n.clear()}});return r};n.fieldDialog=r},{"./doctype-tab.js":14,"./field-elems.js":17}],17:[function(e,t,n){var i=e("../form.js"),s=e("../utils.js"),r=function(){"use strict";var e={};return e.attrs=["name","label","order","description","subcategory","head","reversal","default","required","allowed","source","max","min","regex","doctype","fieldset","charseq","rev","field"],e.get=function(t){var n={};return n.attrs=e.attrs,n.notDefault=function(){return[n.charseq,n.allowed,n.source,n.min,n.max,n.regex]},n.disable=function(){return n.notDefault().forEach(function(e){e.attr("disabled","disabled")}),n},n.clearDisabled=function(){return n.notDefault().forEach(function(e){e.attr("disabled")&&e.val("")}),n},n.copyValues=function(e){return Object.keys(e).forEach(function(t){n[t].val(e[t]),n[t].is("input[type=checkbox]")&&"true"===e[t]&&n[t].prop("checked",!0)}),n},n.getFieldInputVals=function(){var e={category:"field",name:n.name.val(),label:n.label.val(),"default":n.decodeDefaults(n.subcategory.val(),n["default"].val()),head:n.head.is(":checked"),reversal:n.reversal.is(":checked"),required:n.required.is(":checked"),order:1*n.order.val(),allowed:n.allowed.val().split(",").trimAll(),source:n.decodeSource(n.subcategory.val(),n.source.val()),min:n.decodeBound(n.subcategory.val(),n.min.val()),max:n.decodeBound(n.subcategory.val(),n.max.val()),regex:n.regex.val(),description:n.description.val(),charseq:n.charseq.val(),doctype:n.doctype.val(),fieldset:n.fieldset.val(),subcategory:n.subcategory.val()};return e},n.clear=function(){return i.clear($("#field-dialog .input")).removeClass("ui-state-error"),n.disable(),n},n.decodeBound=function(e,t){return"date"===e?t:s.stringToNumber(t)},n.decodeSource=function(e,t){return"file"===e?t.split("/").trimAll():t},n.decodeDefaults=function(e,t){switch(e){case"docmultiselect":case"multiselect":return t.split(",").trimAll();case"file":return t.split("/").trimAll();default:return t}},n.displayFields=function(e){switch(e){case"select":case"multiselect":n.disable(),n.allowed.removeAttr("disabled");break;case"docselect":case"docmultiselect":case"file":n.disable(),n.source.removeAttr("disabled");break;case"text":case"textarea":n.disable(),n.charseq.removeAttr("disabled"),n.regex.removeAttr("disabled");break;case"date":case"integer":case"rational":n.disable(),n.min.removeAttr("disabled"),n.max.removeAttr("disabled");break;default:n.disable()}},n.attrs.forEach(function(e){n[e]=$("#field-"+e+"-input")}),n.copyValues(t),n.displayFields(n.subcategory.val()),n.subcategory.change(function(){n.displayFields(n.subcategory.val())}),n},e}();n.fieldElems=r},{"../form.js":35,"../utils.js":59}],18:[function(e,t,n){var i=e("./fieldset-elems.js").fieldsetElems,s=e("./doctype-tab.js"),r=function(e,t){"use strict";var n=i.get(t),r=$("#fieldset-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Save:function(){var i=n.getFieldsetInputVals(),r=function(t){e.fieldset=!1,e.rev=!1,s.initFieldsets(e),$(t).dialog("close")};!t.rev||t.rev.isBlank()?e.post(i,r,this):(i._id=e.fieldset,e.put(i,r,this))},Cancel:function(){$(this).dialog("close")}},close:function(){n.clear()}});return r};n.fieldsetDialog=r},{"./doctype-tab.js":14,"./fieldset-elems.js":19}],19:[function(e,t,n){var i=e("../form.js"),s=function(){"use strict";var e={};return e.attrs=["name","label","order","description","doctype","rev","multiple","collapse","fieldset"],e.get=function(t){var n={};return n.attrs=e.attrs,n.copyValues=function(e){return Object.keys(e).forEach(function(t){n[t].val(e[t]),n[t].is("input[type=checkbox]")&&"true"===e[t]&&n[t].attr("checked",!0)}),n},n.getFieldsetInputVals=function(){var e={category:"fieldset",name:n.name.val(),label:n.label.val(),order:1*n.order.val(),description:n.description.val(),doctype:n.doctype.val(),multiple:n.multiple.is(":checked"),collapse:n.collapse.is(":checked")};return e},n.clear=function(){return i.clear($("#fieldset-dialog .input")).removeClass("ui-state-error"),n},n.attrs.forEach(function(e){n[e]=$("#fieldset-"+e+"-input")}),n.copyValues(t),n},e}();n.fieldsetElems=s},{"../form.js":35}],20:[function(e,t,n){var i=e("templates.js"),s=e("../form.js"),r=e("../flash.js"),a=function(){"use strict";return s.send("config/upgrade","null","POST",function(){r.highlight("Task Started","Upgrade Project")}),"upgrade-initiated"},o=function(){"use strict";var e=i["config-maintenance"]();return document.getElementById("config-maintenance").insertAdjacentHTML("beforeend",e),"maintenanceui-initialized"};n.init=o,n.upgradeButton=a},{"../flash.js":34,"../form.js":35,"templates.js":"e8H8MT"}],21:[function(e,t,n){var i=e("./dispatcher.js").dispatcher,s=e("./panel-toggle.js").panelToggler,r=e("./documents/searchui.js"),a=e("./documents/worksheetui.js"),o=function(e){"use strict";var t=i({".search-result-field-id a":function(e){r.addField($(e).parent("h5"))},".field-view b":function(e){r.addField($(e).parent("li"))},".field-container label span":function(e){r.addField($(e).parent("label").parent("div"))},"#index-index-input-label":function(){r.addIndex()},".panel > h2":function(e){s(e)},"#toggle-handles":function(){a.hideHandles()},".fieldset-handle":function(e){a.hideFieldset($(e).attr("data-field-fieldset"))},".field-handle":function(e){a.hideField($(e).attr("data-field-field"))}});t(e)};n.dblclickDispatch=o},{"./dispatcher.js":22,"./documents/searchui.js":29,"./documents/worksheetui.js":32,"./panel-toggle.js":50}],22:[function(e,t,n){var i=function(e){"use strict";var t=function(t){var n=$(t.target);Object.keys(e).forEach(function(t){if(n.is(t)){var i=e[t];i(n)}})};return t};n.dispatcher=i},{}],23:[function(e,t,n){var i=e("../pager.js").pager,s=function(){"use strict";return"changelog"},r=function(){"use strict";var e=s(),t=document.getElementById(s()+"-listing"),n=function(e){var t=JSON.parse(e);return t.rows.map(function(e){e.doc.changes&&(e.doc.changes=Object.keys(e.doc.changes).map(function(t){return e.doc.changes[t]}))}),t};return i({prefix:s(),url:e,format:n,target:t}).get(),!0};n.prefix=s,n.get=r},{"../pager.js":49}],24:[function(e,t,n){var i=e("./editui.js"),s=e("../sender.js"),r=function(){"use strict";return document.getElementById("edit-command-input")},a=function(){"use strict";return $("#command-dialog")},o=function(e,t){"use strict";return e.attr("data-last-active",t)},c=function(e){"use strict";return e.attr("data-last-active")},u=function(e){"use strict";var t=!0;switch(e){case"w":case"clear":i.clear();break;case"c":case"create":i.create(),t=!1;break;case"s":case"save":i.save();break;case"d":case"delete":$("#document-view").show(),"none"!==$("#document-delete-button").css("display")&&$("#document-delete-button").click();break;case"e":case"edit":$("#document-view").show(),"none"!==$("#document-edit-button").css("display")&&($("#document-edit-button").click(),t=!1);break;case"r":case"restore":$("#document-view").show(),"none"!==$("#document-restore-button").css("display")&&$("#document-restore-button").click()}if(t){var n=a(),r=c(n);$("#"+r).focus()}else s.sender("lost-focus");return s.sender("executed-command"),!0},l=function(e){"use strict";var t=r(),n=a();return t.value="",o(n,e).show(),t.focus(),!0},d=function(){"use strict";var e=r(),t=a();return o(t,"").hide(),e.value="",!0};n.execute=u,n.dialogOpen=l,n.dialogClose=d},{"../sender.js":55,"./editui.js":26}],25:[function(e,t,n){var i,s=e("./setsui.js"),r=e("./editui.js"),a=e("./viewui.js"),o=e("./indexui.js"),c=e("./changeui.js"),u=e("../sender.js"),l=e("../store.js").store,d=function(){"use strict";return $("#index-filter-form select").change(function(){o.get()}),!0},f=function(e){"use strict";return e&&a.get(e),!0},b=function(){"use strict";return document.getElementById("all-document-container")},p=function(){"use strict";return i()+"_version"},h=function(){"use strict";return i()+"_info"},v=function(){"use strict";return i()+"_labels"},m=function(e){"use strict";return sessionStorage.setItem(h(),e),u.sender("doctype-info-ready")},g=function(){"use strict";return sessionStorage.getItem(p())},y=function(){"use strict";return l(b()).d("version")},j=function(){"use strict";return g()&&g()===y()},w=function(){"use strict";return null!==sessionStorage.getItem(h())},x=function(){"use strict";return null!==sessionStorage.getItem(v())},k=function(){"use strict";return sessionStorage.setItem(p(),y()),u.sender("version-set"),!0},_=function(){"use strict";var e;return e=j()&&w()&&x()?u.sender("labels-ready"):u.sender("bad-session-state")},S=function(){"use strict";return l(b()).d("doctype")},T=function(){"use strict";var e=document.getElementById("container");return l(e).get("project-id")},I=function(){"use strict";return sessionStorage.clear(),u.sender("session-cleared"),!0};i=function(){"use strict";return T()+"_"+S()};var C=function(){"use strict";return JSON.parse(sessionStorage.getItem(h()))},E=function(){"use strict";return $.getJSON("./",function(e){m(JSON.stringify(e))}),!0},O=function(){"use strict";var e=C(),t={};return e.fieldsets.forEach(function(e){e.fields.forEach(function(n){t[n._id]=[e.label,n.label]})}),sessionStorage.setItem(v(),JSON.stringify(t)),u.sender("labels-ready")},D=function(){"use strict";$("form").on("submit",function(){return!1}),_(),s.updateSelection(),o.iOpts(),o.get(),d(),r.init(),f($(location)[0].hash.split("#")[1]),c.get()};n.setVersion=k,n.clearSession=I,n.identifier=i,n.info=C,n.loadDoctype=E,n.makeLabels=O,n.init=D},{"../sender.js":55,"../store.js":58,"./changeui.js":23,"./editui.js":26,"./indexui.js":28,"./setsui.js":30,"./viewui.js":31}],26:[function(e,t,n){var i,s=e("../store.js").store,r=e("../form.js"),a=e("../flash.js"),o=e("./fieldsets.js"),c=e("./viewui.js"),u=e("./indexui.js"),l=function(){"use strict";return $("#save-document-button")},d=function(){"use strict";return $("#create-document-button")},f=function(){"use strict";return $("#document-edit-button")},b=function(e){"use strict";var t=JSON.parse(e.responseText),n=e.statusText,i=$("[data-field-instance="+t.instance+"]"),s=$("[href=#"+i.parents("fieldset").attr("id")+"]").parent("li");return s.addClass("ui-state-error"),i.addClass("ui-state-error"),a.error(n,t.fieldname+" "+t.message),!0},p=function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=function(){return t.map(function(){return t[Math.floor(Math.random()*t.length)]}).join("")};return $("#last-added [data-field-instance]").each(function(t,i){var s=$(i).first(),r=s.attr("data-field-instance"),a=r;e&&(a=n()),s.attr("data-group-id",a),s.attr("id",a),s.attr("data-field-instance",a),s.next(".expander").attr("data-group-id",a),s.next().next(".expander").attr("data-group-id",a)}),e&&$("#last-added").removeAttr("id"),!0},h=function(){"use strict";var e="documents/edit";return $.get(e,function(e){$("#document-edit").html(e),$("#edit-tabs").tabs(),o.initFieldsets()}),!0},v=function(){"use strict";var e="input, select, textarea",t=function(){return $("#edit-tabs")},n=t().find(".ui-tabs-active a").attr("href");return $(n).find(e).first().focus(),!0},m=function(e){"use strict";return i(e),!0},g=function(){"use strict";var e=["data-document-id","data-document-rev"];return e.forEach(function(e){l().attr(e,f().attr(e))}),l().show(),i(),!0};i=function(e){"use strict";return r.initDateFields(),p(e),!0};var y=function(){"use strict";return $(".field").each(function(){var e=$(this),t=e.attr("data-field-default");
t&&""!==t?e.is("select.multiselect")?e.val(t.split(",")):e.is("input.boolean")?e.attr("checked",t===!0):e.val(t):(e.val(""),e.removeAttr("checked"))}),!0},j=function(){"use strict";if(l().hasClass("oldrev")&&!window.confirm("This data is from an older version of this document. Are you sure you want to restore it?"))return!1;var e,t,n=s(l()),i=$("#edit-document-form"),r=n.d("document"),d=n.d("rev"),f="./documents/"+r+"?rev="+d,p=$("#first-index-element").attr("data-first-key"),h=$("#first-index-element").attr("data-first-id"),v={doctype:n.d("doctype"),description:n.d("description")};$("#edit-document-form .ui-state-error").removeClass("ui-state-error"),l().hide(),$.extend(v,o.fieldsetsToObject(i)),$.ajax({type:"PUT",url:f,dataType:"json",contentType:"application/json",processData:!1,data:JSON.stringify(v),complete:function(n){204===n.status||200===n.status?(t="Success",e="Your document was saved.",c.get(r),u.get(p,h),a.highlight(t,e),l().removeClass("oldrev").show()):403===n.status?(b(n),l().show()):409===n.status&&(e=JSON.parse(n.responseText),t=n.statusText,a.error(t,e.message),l().hide())}})},w=function(){"use strict";var e=s(d()),t=$("#edit-document-form"),n=$("#first-index-element").attr("data-first-key"),i=$("#first-index-element").attr("data-first-id"),r={doctype:e.d("doctype"),description:e.d("description")};$("#edit-document-form .ui-state-error").removeClass("ui-state-error"),d().hide(),$.extend(r,o.fieldsetsToObject(t));var f=$.ajax({type:"POST",dataType:"json",contentType:"application/json",processData:!1,data:JSON.stringify(r),complete:function(e){if(201===e.status){var t="Success",s="Your document was created.",r=f.getResponseHeader("Location").match(/[a-z0-9]*$/);l().hide().attr("disabled","true"),$(".fields").remove(),o.initFieldsets(),c.get(r),u.get(n,i),a.highlight(t,s),d().show()}else 403===e.status&&(b(e),d().show())}})},x=function(){"use strict";$("#edit-document-form .ui-state-error").removeClass("ui-state-error"),l().hide().attr("disabled","disabled"),$(".fields").remove(),o.initFieldsets()},k=function(e){"use strict";var t=$("#"+e.attr("data-group-id"));return e.attr("id")===t.attr("data-group-id")?(t.toggleClass("expanded"),t.next().next("span").toggleClass("expanded")):(t.toggleClass("expanded"),e.toggleClass("expanded")),!0};n.init=h,n.selectInput=v,n.afterFreshRefresh=m,n.afterEditRefresh=g,n.afterRefresh=i,n.resetFields=y,n.save=j,n.create=w,n.clear=x,n.toggleTextarea=k},{"../flash.js":34,"../form.js":35,"../store.js":58,"./fieldsets.js":27,"./indexui.js":28,"./viewui.js":31}],27:[function(e,t,n){var i,s,r,a,o,c,u=e("../path.js").path,l=e("../store.js").store,d=e("../utils.js"),f=e("./editui.js"),b=function(e){"use strict";return $("#container-"+e)},p=function(e,t){"use strict";var n=u(e,t);return n.doctype=!1,n},h=function(e,t,n){"use strict";var i=null;i=sessionStorage.getItem(e),i?t(i):$.get(e,n)},v=function(e,t){"use strict";e=e.children(".field-container").children(".field");var n={fields:[]};return e.each(function(e,s){s=$(s);var a=l(s),o=r(s),c=a.f("instance");n.fields[e]={id:a.f("field"),name:a.f("name"),label:a.f("label"),head:"true"===a.f("head"),reversal:"true"===a.f("reversal"),required:"true"===a.f("required"),min:i(a.f("subcategory"),a.f("min")),max:i(a.f("subcategory"),a.f("max")),instance:c,charseq:a.f("charseq"),regex:a.f("regex"),order:1*a.f("order"),subcategory:a.f("subcategory"),value:o},t>=0&&(n.fields[e].index=t)}),n};i=function(e,t){"use strict";return"date"===e?t:d.stringToNumber(t)};var m=function(e){"use strict";switch(e){case"true":e=!0;break;case"false":e=!1;break;default:e=null}return e},g=function(e){"use strict";return d.isBlank(e)?e="":isNaN(e)||(e=1*e),e},y=function(e){"use strict";return e=e?e.map(function(e){return s(e)}):null};s=function(e){"use strict";return window.decodeURIComponent(e.replace(/\+/g," "))},r=function(e){"use strict";var t;switch(l(e).f("subcategory")){case"boolean":t=e.is("input:checkbox:checked");break;case"openboolean":t=m(e.val());break;case"integer":case"rational":t=g(e.val());break;case"multiselect":case"docmultiselect":t=y(e.val());break;case"select":case"docselect":t=s(e.val());break;default:t=e.val()}return t};var j=function(e,t,n){"use strict";var i=p(e,"field"),s=e.children(".fields").last(),r=function(e){n&&s.attr("id","last-added"),s.prepend(e),t&&t(s),f.afterFreshRefresh(n)},a=function(e){sessionStorage.setItem(i,e),r(e)};return h(""+i,r,a),!0},w=function(e){"use strict";e=$(e);var t=l(e).fs("fieldset"),n=$("#container-"+t);p(e,"fieldset"),n.html(""),e.find(".multifield").each(function(e,t){c(n,function(e){a($(t),e)})})},x=function(e){"use strict";a($(e))};a=function(e,t){"use strict";$("#edit-document-form .ui-state-error").removeClass("ui-state-error"),$("#save-document-button").show(),e.find(".field-view").each(function(e,n){var i,s=$(n).attr("data-field-value"),r=$(n).attr("data-field-field"),a=$(n).attr("data-field-instance");s&&(i=JSON.parse(s)),t||(t=$("body")),o(t.find(".field[data-field-field="+r+"]"),i,a)})},o=function(e,t,n){"use strict";e.is("input.boolean")?e.prop("checked",t):t&&e.is("select.open-boolean")?e.val(""+t):t&&e.is("select.multiselect")?(t=t.map(function(e){return encodeURIComponent(e).replace(/[!'()]/g,window.escape).replace(/\*/g,"%2A")}),e.val(t)):t&&e.is("select.select")?(t=encodeURIComponent(t).replace(/[!'()]/g,window.escape).replace(/\*/g,"%2A"),e.val(t)):t&&(e.is("input.text")||e.is("select.file"))?e.val(decodeURIComponent(t.replace(/\+/g," "))):e.val(t),e.attr("data-field-instance",n)},c=function(e,t,n){"use strict";var i=""+p($(e),"fieldset"),s=l($(e)).fs("fieldset"),r=$("#container-"+s),a=function(e){r.append(e),j(r,t,n)},o=function(e){sessionStorage.setItem(i,e),a(e)};return h(""+i,a,o),!1};var k=function(e){"use strict";var t={fieldsets:[]};return e.find("fieldset").each(function(e,n){n=$(n);var i,s=l(n),r={id:s.fs("fieldset"),multiple:"true"===s.fs("multiple"),collapse:"true"===s.fs("collapse"),name:s.fs("name"),label:s.fs("label"),order:1*s.fs("order")};i=b(r.id).children(".fields"),r.multiple?(r.multifields=[],i.each(function(e,t){t=$(t),r.multifields[e]=v(t,e)})):$.extend(r,v(i.first())),t.fieldsets[e]=r}),t},_=function(){"use strict";return $("fieldset").each(function(e,t){var n=l($(t));"false"===n.fs("multiple")&&c(t,!1)}),!0},S=function(e){"use strict";e.parent().remove()},T=function(){"use strict";return $(".fieldset-view").each(function(e,t){"true"===l($(t)).fs("multiple")?w(t):x(t)}),f.afterEditRefresh(),!0};n.initFieldset=c,n.fieldsetsToObject=k,n.initFieldsets=_,n.removeFieldset=S,n.fillFieldsets=T},{"../path.js":51,"../store.js":58,"../utils.js":59,"./editui.js":26}],28:[function(e,t,n){var i=e("templates.js"),s=e("../pager.js").pager,r=e("./viewui.js"),a=e("./editui.js"),o=function(){"use strict";return"index"},c=function(){"use strict";var e="documents/"+o(),t=document.getElementById("index-"+o()+"-input").value,n=document.getElementById(o()+"-listing"),i=function(e){var n=JSON.parse(e);return n.rows=n.rows.map(function(e){return e.display_key=e.key.map(function(e){return e[1]}),t&&e.value.length>0&&(e.value=e.value.split(", ")),e}),n};return s({prefix:o(),format:i,url:e,indexId:t,target:n}).get(),!0},u=function(){"use strict";var e,t="indexes?as=options";return $.getJSON(t,function(t){e=i["index-options"](t),$("#index-index-input").html(e)}),!0},l=function(e){"use strict";var t=$(e).attr("href").slice(1);return $("#document-view").html("<em>Loading...</em>"),a.clear(),r.get(t),!0};n.prefix=o,n.get=c,n.iOpts=u,n.load=l},{"../pager.js":49,"./editui.js":26,"./viewui.js":31,"templates.js":"e8H8MT"}],29:[function(e,t,n){var i=e("templates.js");e("../utils.js");var s=e("../sets.js");e("./setsui.js");var r,a,o=e("./documents.js"),c=function(){"use strict";return $("#document-search-index")},u=function(){"use strict";return $("#search-index-label")},l=function(){"use strict";return $("#document-search-term")},d=function(){"use strict";return $("#document-search-field")},f=function(){"use strict";return $("#search-field-label")},b=function(){"use strict";return $("#document-search-exclude")},p=function(){"use strict";return $("#document-search-invert")},h=function(){"use strict";return $("#search-all-fields-switch")},v=function(){"use strict";return $("#search-listing")},m=function(){"use strict";return o.identifier()},g=[c,u,d,f,b,p,h],y=function(){"use strict";var e=$("#index-index-input").val();return 0===e.length?null:e},j=function(e){"use strict";return e?!0:null},w=function(){"use strict";var e=m();localStorage.setItem(e+"_searchIndex",null),localStorage.setItem(e+"_searchIndexLabel",null),localStorage.setItem(e+"_searchFields",null),localStorage.setItem(e+"_searchExclude",null),localStorage.setItem(e+"_searchInvert",null)},x=function(){"use strict";g.forEach(function(e){var t=e();switch(t.attr("type")){case"hidden":t.val("");break;case"checkbox":t.prop("checked",!1)}})},k=function(){"use strict";g.forEach(function(e){var t=e();switch(t.attr("type")){case"hidden":break;case"checkbox":t.parent("div").hide();break;default:t.hide()}})},_=function(){"use strict";var e=m(),t=JSON.parse(sessionStorage.getItem(e+"_labels"));return t},S=function(e,t){"use strict";return i["search-field-item"]({fieldLabel:t,field:e})},T=function(e){"use strict";var t=_(),n=JSON.stringify(e),i=f(),s=m();d().val(n),localStorage.setItem(s+"_searchFields",n);var r=e.map(function(e){return S(e,t[e].join(": "))});return i.html(r.join(" ")),!0},I=function(){"use strict";return w(),k(),x(),!0},C=function(e){"use strict";return r(e),p().parent().show(),!0},E=function(e){"use strict";var t=m();return C(e),p().prop("checked",!0),localStorage.setItem(t+"_searchInvert",!0),!0};r=function(e){"use strict";return I(),T(e),[h(),f(),b().parent()].forEach(function(e){e.show()}),!0};var O=function(e){"use strict";var t=m();return e.length>1?r(e):C(e),b().prop("checked",!0),localStorage.setItem(t+"_searchExclude",!0),!0},D=function(e,t){"use strict";var n=m();return I(),localStorage.setItem(n+"_searchIndex",e),localStorage.setItem(n+"_searchIndexLabel",t),c().val(e),u().html(t),[h(),c(),u(),p().parent()].forEach(function(e){e.show()}),!0},F=function(e,t){"use strict";var n=m();return D(e,t),p().prop("checked",!0),localStorage.setItem(n+"_searchInvert",!0),!0},A=function(){"use strict";var e=l().val(),t="documents/search?q="+window.encodeURIComponent(e),n=d().val(),i=b().is(":checked"),s=p().is(":checked"),r=c().val(),a=_();return r?t=t+"&index="+r:(n&&(t=t+"&field="+n),i&&(t+="&exclude=true")),s&&(t+="&invert=true"),v().hide(),$.get(t,function(t){v().html(t),$(".search-result-field-id").each(function(e,t){var n=a[$(t).attr("data-field-field")].join(": "),i=$(t).children("a").first();i.html(n),i.attr("data-search-label",n)}),s||$(".search-results th").each(function(t,n){var i=$.trim($(n).children("a").html()),s=RegExp("("+e+")","g"),r=i.replace(s,'<span class="highlight">$1</span>');$(n).children("a").html(r)}),v().show()}),!0},q=function(e){"use strict";var t,n,i=m(),s=localStorage.getItem(i+"_searchFields"),r=JSON.parse(s),o=$(e).attr("data-field-field");return null!==r&&(n=r.filter(function(e){return e!==o}),t=JSON.stringify(n),localStorage.setItem(i+"_searchFields",0===n.length?null:t),localStorage.setItem(i+"_searchIndex",null),a()),!0},N=function(e){"use strict";var t,n,i=m(),r=localStorage.getItem(i+"_searchFields"),o=JSON.parse(r),c=$(e).attr("data-field-field");return null===o&&(o=[]),n=s.union(o,c),t=JSON.stringify(n),localStorage.setItem(i+"_searchFields",0===n.length?null:t),localStorage.setItem(i+"_searchIndex",null),a(),!0},J=function(){"use strict";var e=y(),t=m();return e&&(localStorage.setItem(t+"_searchFields",null),localStorage.setItem(t+"_searchIndex",e),localStorage.setItem(t+"_searchIndexLabel",$("option[value="+e+"]").html()),a()),!0},B=function(){"use strict";var e=m();return localStorage.setItem(e+"_searchInvert",j(p().is(":checked"))),localStorage.setItem(e+"_searchExclude",null),a(),!0},L=function(){"use strict";var e=m();return localStorage.setItem(e+"_searchExclude",j(b().is(":checked"))),localStorage.getItem(e+"_searchInvert",null),a(),!0};a=function(){"use strict";var e,t,n=m(),i=localStorage.getItem(n+"_searchExclude"),s=localStorage.getItem(n+"_searchInvert"),a=localStorage.getItem(n+"_searchIndex"),o=localStorage.getItem(n+"_searchFields"),c=[i,s,a,o].map(function(e){return"null"===e||"false"===e||"true"===e?JSON.parse(e):e}),u=c.every(function(e){return null===e});try{u?I():c[0]===!0?(e=JSON.parse(o),O(e)):null===c[1]&&null!==c[3]?(e=JSON.parse(o),e.length>1?r(e):C(e)):null!==c[3]?(e=JSON.parse(o),e.length>1?r(e):E(e)):null===c[1]?(t=localStorage.getItem(n+"_searchIndexLabel"),D(a,t)):c[1]===!0&&(t=localStorage.getItem(n+"_searchIndexLabel"),F(a,t))}catch(l){window.console.log(l),I()}return!0};var V=function(e){"use strict";var t=$(e);return t.is(":checked")?t.next("label").next("table").addClass("selected-for-save"):t.next("label").next("table").removeClass("selected-for-save"),!0};n.allFields=I,n.singleField=C,n.singleFieldInverse=E,n.multipleFields=r,n.excludedFields=O,n.indexOnly=D,n.indexInverse=F,n.getSearch=A,n.removeField=q,n.addField=N,n.addIndex=J,n.toggleInversion=B,n.toggleExclusion=L,n.loadSearchVals=a,n.toggleSelection=V},{"../sets.js":57,"../utils.js":59,"./documents.js":25,"./setsui.js":30,"templates.js":"e8H8MT"}],30:[function(e,t,n){var i,s,r,a,o,c,u,l=e("templates.js"),d=e("../sender.js"),f=e("../flash.js"),b=e("../sets.js"),p=e("../utils.js"),h=e("./documents.js"),v=function(){"use strict";return $("#document-set-a-input")},m=function(){"use strict";return $("#document-set-b-input")},g=function(){"use strict";return $("#document-worksheets-set-input")},y=function(){"use strict";return $("#document-set-operation-input")},j=function(){"use strict";return $("#set-listing")},w=function(){"use strict";return h.identifier()+"_sets"},x=function(e,t){"use strict";return e.some(function(e){return t[0]===e[0]&&t[1]===e[1]})},k=function(e){"use strict";var t=e[0],n=b.unique(e[1],x),i=[t,n];return i},_=function(e,t){"use strict";var n=u(e)[1],i=u(t)[1],s=b.union(n,i,x);return o(s),!0},S=function(e,t){"use strict";var n=u(e)[1],i=u(t)[1],s=b.intersection(n,i,x);return o(s),!0},T=function(e,t){"use strict";var n=u(e)[1],i=u(t)[1],s=b.relativeComplement(n,i,x);return o(s),!0},I=function(e,t){"use strict";var n=u(e)[1],i=u(t)[1],s=b.symmetricDifference(n,i,x);return o(s),!0};c=function(){"use strict";var e=window.sessionStorage.getItem(w()),t=[];return null!==e&&(t=JSON.parse(e)),t};var C=function(e){"use strict";var t=u(e)[1];return o(t),!0},E=function(e){"use strict";return i(e),o([]),d.sender("sets-changed"),!0};i=function(e){"use strict";var t,n=c();return t=n.filter(function(t){return t[0]!==e}),s(t),!0};var O=function(){"use strict";var e=c();return e.map(function(e){return e[0]})};s=function(e){"use strict";var t;return Array.isArray(e)?(t=e.map(function(e){return k(e)}),window.sessionStorage.setItem(w(),JSON.stringify(t))):window.sessionStorage.settem(w(),"[]"),!0};var D=function(e){"use strict";if(Array.isArray(e)&&2===e.length){var t=c(),n=e[0],i=t.filter(function(e){return e[0]!==n});s(i.concat([e]))}return!0},F=function(e){"use strict";var t=[];switch(e){case"search":t=a();break;case"sets":t=r()}return t};r=function(){"use strict";var e,t=$("input.set-element-selection:checked");return e=$.map(t,function(e){var t=$(e).parent("td").next("td").find("a").first(),n=t.first().attr("href").replace(/^#/,""),i=t.html().trim();return[[i,n]]})},a=function(){"use strict";var e,t=$("table.selected-for-save tr");return e=$.map(t,function(e){var t=$(e).find("th a").first().attr("href").replace(/^#/,""),n=$(e).find("td.search-result-context a").first().html().trim();return[[n,t]]})},o=function(e){"use strict";var t=e.length,n=e.map(function(e){return{id:e[1],context:e[0]}}),i=l["set-listing"]({elements:n,total:t});return j().html(i),!0};var u=function(e){"use strict";var t,n=c();return t=n.filter(function(t){return t[0]===e})[0]},A=function(){"use strict";switch(y().val()){case"view-a":C(v().val());break;case"view-b":C(m().val());break;case"remove-a":E(v().val());break;case"remove-b":E(m().val());break;case"union":_(v().val(),m().val());break;case"intersection":S(v().val(),m().val());break;case"symmetric-difference":I(v().val(),m().val());break;case"relative-complement-b-in-a":T(v().val(),m().val());break;case"relative-complement-a-in-b":T(m().val(),v().val());break;default:}return!0},q=function(){"use strict";var e=O(),t=l["set-options"]({names:e});return v().html(t),m().html(t),g().html(t),!0},N=function(){"use strict";var e,t,n=$("#new-set-dialog"),i=$("#new-set-input").val(),s=$("#new-set-target-input").val();return p.isBlank(i)?f.error("Input invalid:","You must supply a valid name."):(n.hide(),e=F(s),t=[i,e],D(t),$("#new-set-input").val(""),d.sender("sets-changed"),f.highlight("Success:",'Set "'+i+'" saved.')),!0},J=function(e){"use strict";return $(e).is(":checked")?$("input.set-element-selection").prop("checked",!0):$("input.set-element-selection").prop("checked",!1),!0};n.getSet=u,n.performOp=A,n.updateSelection=q,n.saveSelected=N,n.toggleSelectAll=J},{"../flash.js":34,"../sender.js":55,"../sets.js":57,"../utils.js":59,"./documents.js":25,"templates.js":"e8H8MT"}],31:[function(e,t,n){var i=e("templates.js"),s=e("../store.js").store,r=e("./indexui.js"),a=e("../flash.js"),o=e("./editui.js"),c=e("./fieldsets.js"),u=function(){"use strict";return $("#document-view")},l=function(){"use strict";return $("#document-view-tree")},d=function(){"use strict";return $("#document-view-info")},f=function(e){"use strict";return Object.keys(e).reduce(function(t,n){return void 0===e[n].newValue&&(void 0===t[e[n].fieldset]&&(t[e[n].fieldset]={}),t[e[n].fieldset][n]=e[n]),t},{})},b=function(e){"use strict";var t={};return e.changes&&(t=f(e.changes)),e.fieldsets.forEach(function(n){var i=n.id;void 0!==t[i]&&(n.removal=!0,n.altered=!0);var s=function(t){var i,s={};return e.changes&&(s=e.changes),i=s[t.instance],t.json_value=JSON.stringify(t.value),void 0!==i&&(t.changed=!0,n.altered=!0,void 0===i.originalValue?(n.addition=!0,t.newfield=!0):t.originalValue=JSON.parse(i.originalValue)),"textarea"===t.subcategory?t.is_textarea=!0:t.value&&t.subcategory.match("multi")&&(t.value=t.value.join(", ")),!0};return n.multiple?n.multifields.forEach(function(e){e.fields.forEach(function(e){return s(e),!0})}):n.fields.forEach(function(e){return s(e),!0}),!0}),!0},p=function(){"use strict";return $(".timestamp").each(function(e,t){var n=new Date($(t).text()).toLocaleString();"Invalid Date"!==n&&$(t).text(n)}),!0},h=function(e,t,n){"use strict";var r,a="documents/"+e,o=u();return t?(a=a+"/"+t,o=l(),r=function(e){return i["document-view-tree"](e)}):r=function(e){return i["document-view"](e)},$.getJSON(a,function(i){var a;if(b(i,t),a=r(i),o.html(a),window.location.hash=e,p(),u().fadeTo("slow",1),n&&n(),t)$("#document-view-tree").addClass("oldrev");else{var c=$("#document-restore-button"),l=$("#document-edit-button"),d=$("#document-delete-button");"true"===s(c).d("deleted")&&(l.hide(),d.hide(),c.show())}}),!0},v=function(e,t){"use strict";var n="./documents/"+e+"?rev="+t;$("#document-restore-button");var i,s,o=$("#first-index-element").attr("data-first-key"),c=$("#first-index-element").attr("data-first-id");return $.ajax({type:"DELETE",url:n,dataType:"json",contentType:"application/json",complete:function(t){200===t.status?(s="Success",i="Your document was restored.",h(e,null,function(){u().fadeTo("slow",1),r.get(o,c)}),a.highlight(s,i)):409===t.status?(i=JSON.parse(t.responseText),s=t.statusText,a.error(s,i.message)):404===t.status&&(i="Document was erased and cannot be restored.",s=t.statusText,a.error(s,i))}}),!0},m=function(e,t){"use strict";var n,i,o="./documents/"+e+"?rev="+t,c=$("#document-restore-button"),l=$("#first-index-element").attr("data-first-key"),d=$("#first-index-element").attr("data-first-id");return $.ajax({type:"DELETE",url:o,dataType:"json",contentType:"application/json",complete:function(e){if(200===e.status){i="Success",n="Your document was deleted.";var t=JSON.parse(e.responseText);s(c).put("document-rev",t.rev),$("#document-delete-button").hide(),$("#document-edit-button").hide(),c.show(),u().fadeTo("slow",.5),r.get(l,d),a.highlight(i,n)}else 409===e.status?(n=JSON.parse(e.responseText),i=e.statusText,a.error(i,n.message)):404===e.status&&(n="Document appears to have been deleted already.",i=e.statusText,a.error(i,n))}}),!0},g=function(e){"use strict";if(window.confirm("Are you sure?")){var t=s(d()),n=t.d("document"),i=t.d("rev");e(n,i)}return!0},y=function(){"use strict";return o.resetFields(),$("#document-view-tree").hasClass("oldrev")?$("#save-document-button").addClass("oldrev"):$("#save-document-button").removeClass("oldrev"),c.fillFieldsets(),!0},j=function(){"use strict";var e=s(d()),t=e.d("document"),n=e.d("rev");return g(function(){m(t,n)})},w=function(){"use strict";var e=s(d()),t=e.d("document"),n=e.d("rev");return g(function(){v(t,n)})},x=function(e){"use strict";return $(e).parent("li").toggleClass("collapsed"),!0},k=function(e){"use strict";var t=s($(e)),n=t.d("document"),i=t.d("oldrev");return $(".revision-link").removeClass("selected-revision"),$(e).addClass("selected-revision"),h(n,i),!0};n.formatTimestamps=p,n.get=h,n.restore=v,n.del=m,n.confirmIt=g,n.edit=y,n.confirmDelete=j,n.confirmRestore=w,n.collapseToggle=x,n.fetchRevision=k},{"../flash.js":34,"../store.js":58,"./editui.js":26,"./fieldsets.js":27,"./indexui.js":28,"templates.js":"e8H8MT"}],32:[function(e,t,n){var i=e("hogan.js"),s=e("templates.js"),r=e("./setsui.js"),a=e("./documents.js"),o=e("../form.js"),c=e("../flash.js"),u=function(){"use strict";return $("#document-worksheets-set-input")},l=function(){"use strict";return $("#worksheet-area")},d=function(){"use strict";return a.identifier()+"_worksheet-template"},f=function(e){"use strict";return e?($("#worksheet-table tbody tr").addClass("selected-row"),$("#worksheet-table tbody tr input").prop("checked",!0)):($("#worksheet-table tbody tr").removeClass("selected-row"),$("#worksheet-table tbody tr input:checked").prop("checked",!1)),!0},b=function(e,t){"use strict";return t?($("#"+e).addClass("selected-row"),$("#select-all-worksheet-rows").prop("checked",!1)):($("#"+e).removeClass("selected-row"),$("#select-all-worksheet-rows").prop("checked",!1)),!0},p=function(e,t){"use strict";return t?$(".field-column."+e).addClass("selected-column"):$(".field-column."+e).removeClass("selected-column"),!0},h=function(){"use strict";return $("#worksheet-table .handle-column.fieldset").show(),!0},v=function(){"use strict";return $("#worksheet-table .handle-column.fieldset").hide(),!0},m=function(e){"use strict";return $("#worksheet-table .handle-column.field."+e).show(),!0},g=function(e){"use strict";return $("#worksheet-table .handle-column.field."+e).hide(),!0},y=function(e){"use strict";return $(".field-column."+e).show(),!0},j=function(e){"use strict";return $(".field-column."+e).hide(),!0},w=function(){"use strict";var e=a.info(),t="{{=<% %>=}}\n"+s.worksheet(e);return globals[d()]=i.compile(t),!0},x=function(){"use strict";var e=u().val(),t="worksheets",n=function(e,t){var n=JSON.parse(t.responseText),i=globals[d()].render(n);l().html(i)};if(!e.isBlank()){var i=r.getSet(e)[1];if(250>=i.length){var s=i.map(function(e){return e[1]});o.send(t,s,"POST",n)}else c.error("Could not load worksheet","the current set size is limited to 250 items.")}return!0};n.selectAllRows=f,n.rowSelection=b,n.columnSelection=p,n.showHandles=h,n.hideHandles=v,n.showFieldset=m,n.hideFieldset=g,n.showField=y,n.hideField=j,n.buildTemplate=w,n.fillWorksheet=x},{"../flash.js":34,"../form.js":35,"./documents.js":25,"./setsui.js":30,"hogan.js":2,"templates.js":"e8H8MT"}],33:[function(e,t,n){var i,s=e("../form.js"),r=e("../flash.js"),a=function(e){"use strict";void 0===e&&(e=""),$.get("file_manager/list_dirs/"+e,function(e){$("#file-paths").html(e)})},o=function(e){"use strict";void 0===e&&(e=""),$.get("file_manager/list_files/"+e,function(e){$("#file-listing").html(e)})},c=function(e,t){"use strict";var n=$("#file-path-input");e.path?n.val(e.path.join("/")):n.val("");var a=$("#edit-path-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Move:function(){var o="file_manager/"+e._id+"?rev="+e._rev,c=function(){i(t),r.highlight("Success","File Moved")};e.path=n.val().replace(/^\s*|\s*$/g,"").replace(/\/+/g,"/").replace(/^\/|\/$/g,"").split("/"),s.send(o,e,"PUT",c,a),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}});return a},u=function(){"use strict";i(),$("#file-upload-target").load(function(){var e=$("#file-upload-target").contents().find("body pre").html(),t=function(){return e&&e.length>0?JSON.parse(e):{message:!1}};t()&&t().message&&"success"!==t().status?(r.error("Error",t().message),i()):t().message&&(r.highlight("Success",t().message),i())})},l=function(e){"use strict";var t=$(e).attr("data-path");return window.sessionStorage.fmPath=t,i(t),!0},d=function(){"use strict";return window.sessionStorage.fmPath="",i(),!0},f=function(){"use strict";var e=window.sessionStorage.fmPath,t=e.split("/");return t.pop(),t=t.join("/"),window.sessionStorage.fmPath=t,i(t),!0},b=function(e){"use strict";var t=window.sessionStorage.fmPath,n=e.attr("data-file-id"),i="file_manager/"+n;return $.getJSON(i,function(e){c(e,t).dialog("open")}),!0},p=function(e){"use strict";var t=window.sessionStorage.fmPath,n=e.attr("data-file-id"),a=e.attr("data-file-rev"),o="file_manager/"+n+"?rev="+a,c=function(){i(t),r.highlight("Success","File Deleted")};return s.send(o,null,"DELETE",c,e),!0};i=function(e){"use strict";a(e),o(e)},n.init=u,n.goDir=l,n.rootDir=d,n.upDir=f,n.editFile=b,n.deleteFile=p,n.refreshListings=i},{"../flash.js":34,"../form.js":35}],34:[function(e,t,n){var i=function(e,t,n){"use strict";var i=function(){e.fadeOut()};e.find(".notification-summary").text(t+": "),e.find(".notification-message").text(n);var s=window.setTimeout(i,7e3);e.fadeIn(),e.find(".close").click(function(){window.clearTimeout(s),e.hide()})},s=function(e,t){"use strict";return i($("#notifications-main .ui-state-error"),e,t),!0},r=function(e,t){"use strict";return i($("#notifications-main .ui-state-highlight"),e,t),!0};n.error=s,n.highlight=r},{}],35:[function(e,t,n){var i,s=e("./flash.js"),r=function(e){"use strict";var t,n=$(e);return n.attr("data-target")&&(t=$("#"+n.attr("data-target")),t.toggle()),!0},a=function(e){"use strict";var t,n,s=$(e);return s.attr("data-target")&&(n="#"+s.attr("data-target"),t=$(n),t.hide(),i(void 0,t.find("form"))),!0};i=function(e,t){"use strict";return void 0===e&&(e=$(t).find("input, select, textarea")),e.each(function(e,t){var n=$(t);n.attr("data-retain")||(n.is(":checked")&&n.attr("checked",!1),n.val(""))}),e};var o=function(e,t,n,i,r){"use strict";var a;return t&&(a=JSON.stringify(t)),$.ajax({type:n,url:e,dataType:"json",context:r,contentType:"application/json",processData:!1,data:a,complete:function(e){if(e.status>=200&&300>e.status)i(this,e);else if(500===e.status)s.error("Unknown Server Error","Please report that you received this message");else if(e.status>=400){var t=JSON.parse(e.responseText),n=e.statusText;s.error(n,t.fieldname+" "+t.message)}}}),!0},c=function(e,t){"use strict";return t.append('<span class="validation-error-message">'+e+"</span>").addClass("ui-state-highlight"),setTimeout(function(){t.removeClass("ui-state-highlight",1500)},500),!0},u=function(e,t,n,i,s){"use strict";return e.val().length>i||n>e.val().length?(e.addClass("ui-state-error"),c("Length of "+t+" must be between "+n+" and "+i+".",s),!1):!0},l=function(e,t,n,i){"use strict";return t.test(e.val())?!0:(e.addClass("ui-state-error"),c(n,i),!1)},d=function(){"use strict";return $(".date").datepicker({dateFormat:"yy-mm-dd"}),!0},f=function(e,t,n){"use strict";return $.get(e,function(e){t.html(e),n&&n()}),!1};n.toggle=r,n.cancelDialog=a,n.clear=i,n.send=o,n.updateTips=c,n.checkLength=u,n.checkRegexp=l,n.initDateFields=d,n.fillOptionsFromUrl=f},{"./flash.js":34}],36:[function(e,t,n){e("./recurse.js");var i=e("templates.js"),s=function(e){"use strict";if("string"!=typeof e)throw"invalid HTML: non-string";if(0===e.length)throw'invalid HTML: ""';return e},r=function(e){"use strict";var t="cannot build form from: ";if(null===e)throw t+"null";if("string"==typeof e)throw t+"string";if("number"==typeof e)throw t+"number";if(e.constructor===Array)throw t+"array";if(0===Object.keys(e).length)throw t+"empty object";return e},a=function(e){"use strict";var t;try{t=JSON.parse(e)}catch(n){switch(n.name){case"SyntaxError":throw n.message="invalid JSON: "+JSON.stringify(e),n;default:throw n}}return t},o=function(e){"use strict";var t=Object.keys(e).reduce(function(t,n){var i=e[n],s={key:n,val:i};return"string"==typeof i&&32>=i.length?s.string=!0:"number"==typeof i?s.number=!0:"string"==typeof i&&i.length>32&&(s.text=!0),t.concat(s)},[]);return i["simple-to-form"]({fields:t})},c=function(e){"use strict";var t=a(e);return r(t),o(t)},u=function(e){"use strict";return s(e),"null"};n.toForm=c,n.fromForm=u},{"./recurse.js":54,"templates.js":"e8H8MT"}],37:[function(){},{}],38:[function(e,t,n){e("../jquery-ui-input-state.js");var i=e("./ihelpers.js"),s=e("../form.js"),r=e("./ievents.js"),a=function(e){"use strict";var t=$("#builder-or-input"),n=$("#builder-paren-input"),a=$("#builder-negate-input"),o=$("#builder-operator-input").inputDisable(),c=$("#builder-argument-input").inputDisable(),u=$("#builder-fieldset-input").inputDisable(),l=$("#builder-field-input").inputDisable(),d=[o,u,l],f="doctypes/"+e+"/fieldsets",b="indexes/condition";$(".ui-helper-reset div").show();var p=function(e){var t=$("#index-conditions-listing tbody");return t.append(e),t.sortable(),!1};i.fOpts(f,u,function(){u.inputEnable()}),t.change(function(){t.is(":checked")?($("#builder-conditions").hide(),$("#builder-parens").hide()):($("#builder-conditions").show(),$("#builder-parens").show())}),n.change(function(){n.val()?($("#builder-or").hide(),$("#builder-conditions").hide()):($("#builder-or").show(),$("#builder-conditions").show())});var h=function(){r.setIndexFieldsetEvents(e,u,l,function(){return o.inputDisable(),l.inputDisable(),c.inputDisable(),function(){l.inputEnable()}})},v=function(){r.setIndexFieldEvents(e,u,l,function(){return o.inputDisable(),c.inputDisable(),function(){o.inputEnable()}})},m=function(){r.setIndexOperatorEvents(c,o,l,function(){return c.inputDisable(),function(){c.inputEnable()}})},g=$("#index-builder-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Create:function(){$(".input").removeClass("ui-state-error");var e=!0;t.is(":checked")||n.val()||d.forEach(function(t){t.val().isBlank()?(t.addClass("ui-state-error"),e=!1):t.removeClass("ui-state-error")}),e&&(t.is(":checked")?$.get(b,{is_or:!0},function(e){p(e)}):n.val()?$.get(b,{is_or:!1,parens:n.val(),negate:!1},function(e){p(e)}):$.get(b,{is_or:!1,parens:!1,negate:a.is(":checked"),fieldset:u.val(),field:l.val(),operator:o.val(),argument:c.val()},function(e){p(e)}),$(this).dialog("close"))},Cancel:function(){$(this).dialog("close")}},close:function(){$("#builder-conditions").show(),u.unbind("change"),l.unbind("change"),o.unbind("change"),s.clear($(".input")).removeClass("ui-state-error")}});return h(),v(),m(),g};n.initIndexBuilderDialog=a},{"../form.js":35,"../jquery-ui-input-state.js":46,"./ievents.js":40,"./ihelpers.js":41}],39:[function(e,t,n){var i=e("./new-dialog.js").initIndexNewDialog,s=e("./builder-dialog.js").initIndexBuilderDialog,r=e("./replace-dialog.js").initReplaceDialog,a=e("./ilistingui.js"),o=e("./ipreviewui.js"),c=e("./ihelpers.js"),u=e("../form.js"),l=e("../flash.js"),d=function(){"use strict";return $("#index-conditions-listing tbody")},f=function(){"use strict";return $("#index-editing-data")},b=function(e,t,n){"use strict";switch(t){case"integer":case"rational":e=1*e}switch(n){case"hasExactly":case"hasGreater":case"hasLess":e=Math.floor(1*e)}return e},p=function(e,t){"use strict";var n=t.map(function(t,n){n=$(n);var i,s="true"===n.find("td.or-condition").attr("data-value"),r=n.find("td.paren-condition").attr("data-value");
if(s)i={is_or:!0,parens:!1};else if(r)i={is_or:!1,parens:r};else{var a=n.find("td.field-condition").attr("data-value"),o=n.find("td.fieldset-condition").attr("data-value"),u=n.find("td.argument-condition").attr("data-value"),l=c.getFieldDoc(a,o,e),d="true"===n.find("td.negate-condition").attr("data-value"),f=n.find("td.operator-condition").attr("data-value");u=b(u,l.subcategory,f),i={is_or:!1,parens:!1,negate:d,fieldset:o,field:a,operator:f,argument:u}}return i}).toArray();return n},h=function(e,t){"use strict";var n=e.attr("data-index-id"),i=e.attr("data-index-rev"),s="indexes/"+n+"?rev="+i,r=e.attr("data-index-doctype"),a={_id:n,category:"index",doctype:r,show_deleted:"true"===e.attr("data-index-show_deleted"),fields:JSON.parse(e.attr("data-index-fields")),fields_label:JSON.parse(e.attr("data-index-fields_label")),name:e.attr("data-index-name"),conditions:p(r,$("#index-conditions-listing tbody tr"))};return e.attr("data-index-replace_function")&&(a.replace_function=e.attr("data-index-replace_function")),u.send(s,a,"PUT",t,this),!1},v=function(e,t,n,i){"use strict";var s,r,a="indexes/"+e+"?rev="+t;return $.ajax({type:"DELETE",url:a,dataType:"json",contentType:"application/json",complete:function(e){204===e.status?(s="Success",r=n,i(),l.highlight(s,r)):409===e.status?(r=JSON.parse(e.responseText),s=e.statusText,l.error(s,r.message)):404===e.status&&(r="Index appears to have been deleted already.",s=e.statusText,l.error(s,r))}}),!1},m=function(e){"use strict";var t=$(e).attr("data-index-id"),n="indexes/"+t,i=$("#index-conditions");return $.get(n,function(e){i.html(e),d().sortable(),o.get()}),!1},g=function(){"use strict";var e=f();if(0!==e.length){var t=function(){m(e),l.highlight("Success","Your index has been saved.")};h(e,t)}else l.highlight("Info","No index has been chosen to save.")},y=function(){"use strict";var e=f();return 0!==e.length?r.dialog("open"):l.highlight("Info","You must choose an index first."),!0},j=function(){"use strict";var e=f();return 0!==e.length?s(e.attr("data-index-doctype")).dialog("open"):l.highlight("Info","You must choose an index first."),!0},w=function(e){"use strict";return $(e).closest("tr").remove(),!0},x=function(){"use strict";return i().dialog("open"),!0},k=function(){"use strict";var e=f();if(0!==e.length){var t=e.attr("data-index-id"),n=e.attr("data-index-rev"),i="Your index has been deleted.",s=function(){$("#index-conditions").empty(),a.init()};window.confirm("Are you sure?")&&v(t,n,i,s)}else l.highlight("Info","No index has been chosen to delete.");return!0};n.init=m,n.save=g,n.replace=y,n.addCond=j,n.remCond=w,n.newCond=x,n.del=k},{"../flash.js":34,"../form.js":35,"./builder-dialog.js":38,"./ihelpers.js":41,"./ilistingui.js":42,"./ipreviewui.js":43,"./new-dialog.js":44,"./replace-dialog.js":45}],40:[function(e,t,n){var i=e("./ihelpers.js"),s=function(e,t,n){"use strict";return e.change(function(){var s,r="doctypes/"+e.val()+"/fieldsets";n&&(s=n()),i.fOpts(r,t,s)}),!1},r=function(e,t,n,s){"use strict";return t.change(function(){var r;if("string"!=typeof e&&(e=e.val()),t.val()){var a="doctypes/"+e+"/fieldsets/"+t.val()+"/fields?as=options";s&&(r=s()),i.fOpts(a,n,r)}}),!0},a=function(e,t,n,s){"use strict";return n.change(function(){var r,a=n.val(),o=t.val();s&&(r=s()),a.isBlank()||i.getFieldDoc(a,o,e,function(e){i.alterOpts(e,a,r)})}),!0},o=function(e,t,n,s){"use strict";return t.change(function(){var r;s&&(r=s()),i.alterArg(e,t,n,r)}),!0};n.setIndexOperatorEvents=o,n.setIndexFieldEvents=a,n.setIndexFieldsetEvents=r,n.setIndexDoctypeEvents=s},{"./ihelpers.js":41}],41:[function(e,t,n){var i=e("../sess.js"),s=function(e,t){"use strict";return e.children().show(),t.forEach(function(t){e.children("option:contains("+t+")").hide()}),!1},r=function(e){"use strict";var t=$("#builder-operator-input");switch(e.subcategory){case"select":case"docselect":case"text":case"textarea":s(t,["member","true"]);break;case"integer":case"rational":case"date":s(t,["member","true","match"]);break;case"boolean":case"openboolean":s(t,["equal","greater","less","member","match"]);break;case"multiselect":case"docmultiselect":s(t,["equal","greater","less","true","match"])}return!1},a=function(e,t,n,s){"use strict";var r=function(){return i.get(n.val())};s();try{e.removeAttr("disabled").datepicker("destroy"),e.removeAttr("disabled").autocomplete("destroy")}catch(a){window.console.log(a.message)}var o=function(e,t){return"date"===t.subcategory?(e.removeAttr("disabled"),e.datepicker({dateFormat:"yy-mm-dd"})):(e.removeAttr("disabled"),e.autocomplete({source:t.allowed})),!0},c=r();if(c)switch(t.val()){case"true":case"isDefined":case"blank":e.attr("disabled","disabled").val("");break;case"equal":case"member":case"greater":case"less":case"hasExactly":case"hasGreater":case"hasLess":o(e,c)}return!0},o=function(e,t,n){"use strict";return r(e),n(),!0},c=function(e,t,n){"use strict";return $.get(e,function(e){t.html(e),n&&n()}),!0},u=function(e,t,n,s){"use strict";var r=i.get(e),a="doctypes/"+n+"/fieldsets/"+t+"/fields/"+e+"?format=json";return r?(s&&s(r),r):($.ajax({url:a,async:!1,dataType:"json",success:function(t){i.put(t),s&&s(i.get(e))}}),i.get(e))},l=function(){"use strict";var e={};e.setIndexDoctypeEvents=function(e,t,n){return e.change(function(){var i,s="doctypes/"+e.val()+"/fieldsets";n&&(i=n()),c(s,t,i)}),!1},e.setIndexFieldsetEvents=function(t,n,i,s){return n.change(function(){var e;if("string"!=typeof t&&(t=t.val()),n.val()){var r="doctypes/"+t+"/fieldsets/"+n.val()+"/fields?as=options";s&&(e=s()),c(r,i,e)}}),e},e.setIndexFieldEvents=function(t,n,i,s){return i.change(function(){var e,r=i.val(),a=n.val();s&&(e=s()),r.isBlank()||u(r,a,t,function(t){o(t,r,e)})}),e},e.setIndexOperatorEvents=function(t,n,i,s){return n.change(function(){var e;s&&(e=s()),a(t,n,i,e)}),e}};n.alterArg=a,n.alterOpts=o,n.fOpts=c,n.getFieldDoc=u,n.evs=l},{"../sess.js":56}],42:[function(e,t,n){var i=e("templates.js"),s=function(){"use strict";var e,t="indexes",n=$("#index-index-listing");return $.getJSON(t,function(t){e=i["index-listing"](t),n.html(e)}),!0};n.init=s},{"templates.js":"e8H8MT"}],43:[function(e,t,n){var i=e("../pager.js").pager,s=function(){"use strict";return"preview"},r=function(){"use strict";var e=document.getElementById("index-editing-data").getAttribute("data-index-id"),t="indexes/"+e+"/preview",n=document.getElementById(s()+"-list-view"),r=function(e){var t=JSON.parse(e);return t.rows=t.rows.map(function(e){return e.display_key=e.key.map(function(e){return e[1]}),e}),t};return e&&i({prefix:s(),format:r,url:t,target:n}).get(),!0};n.prefix=s,n.get=r},{"../pager.js":49}],44:[function(e,t,n){e("../jquery-ui-input-state.js"),e("./ihelpers.js");var i=e("./ilistingui.js"),s=e("../form.js"),r=e("./ievents.js"),a=function(){"use strict";var e=$("#index-doctype-input"),t=$("#index-fieldset-input").inputDisable(),n=$("#index-field-input").inputDisable(),a=$("#index-name-input"),o=$("#index-show_deleted-input"),c=function(){r.setIndexDoctypeEvents(e,t,function(){return t.inputDisable(),n.inputDisable(),function(){t.inputEnable()}})},u=function(){r.setIndexFieldsetEvents(e,t,n,function(){return n.inputDisable(),function(){n.inputEnable()}})},l=function(e){return $('#index-new-dialog option[value="'+e+'"]').text()},d=function(){return[l(t.val()),l(n.val())].join(":")},f=$("#index-new-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Create:function(){$(".input").removeClass("ui-state-error");var t=!0;if(t){var r={category:"index",name:a.val(),show_deleted:o.is(":checked"),conditions:[],doctype:e.val(),fields_label:[d()],fields:[n.val()]},c=function(e){i.init(),$(e).dialog("close")};s.send("indexes",r,"POST",c,this)}},Cancel:function(){$(this).dialog("close")}},close:function(){t.unbind("change"),e.unbind("change"),s.clear($(".input")).removeClass("ui-state-error")}});return c(),u(),f};n.initIndexNewDialog=a},{"../form.js":35,"../jquery-ui-input-state.js":46,"./ievents.js":40,"./ihelpers.js":41,"./ilistingui.js":42}],45:[function(e,t,n){e("./ihelpers.js");var i=e("../form.js"),s=function(){"use strict";var e=$("#index-replace_function-input"),t=$("#index-editing-data"),n=$("#index-remove_function-input");t.attr("data-index-replace_function")?e.val(t.attr("data-index-replace_function")):i.clear(e).removeClass("ui-state-error");var s=$("#index-replace-dialog").dialog({autoOpen:!1,modal:!0,buttons:{Save:function(){$(".input").removeClass("ui-state-error");var i=!0;n.is(":checked")?(t.removeAttr("data-index-replace_function"),$("#replace-function-message").empty()):(e.val().isBlank()?e.addClass("ui-state-error"):e.removeClass("ui-state-error"),i&&(t.attr("data-index-replace_function",e.val()),$("#replace-function-message").text("This index has a replacement function."))),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}},close:function(){i.clear(e).removeClass("ui-state-error")}});return s};n.initReplaceDialog=s},{"../form.js":35,"./ihelpers.js":41}],46:[function(){(function(e){"use strict";e.fn.inputDisable=function(){return this.val(""),this.attr("disabled","disabled"),this.addClass("ui-state-disabled"),this},e.fn.inputEnable=function(){return this.removeAttr("disabled"),this.removeClass("ui-state-disabled"),this}})(jQuery)},{}],47:[function(){(function(e){"use strict";function t(t){if("string"==typeof t.data){var n=t.handler,i=t.data.toLowerCase().split(" ");t.handler=function(t){var s="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],r=String.fromCharCode(t.which).toLowerCase(),a="",o={};t.altKey&&"alt"!==s&&(a+="alt+"),t.ctrlKey&&"ctrl"!==s&&(a+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==s&&(a+="meta+"),t.shiftKey&&"shift"!==s&&(a+="shift+"),s?o[a+s]=!0:(o[a+r]=!0,o[a+e.hotkeys.shiftNums[r]]=!0,"shift+"===a&&(o[e.hotkeys.shiftNums[r]]=!0));for(var c=0,u=i.length;u>c;c++)if(o[i[c]])return n.apply(this,arguments)}}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})})(jQuery)},{}],48:[function(e,t,n){e("./jquery.hotkeys.js");var i=e("./sender.js"),s=e("./index_tool/ipreviewui.js"),r=e("./documents/indexui.js"),a=e("./documents/changeui.js"),o=e("./documents/editui.js"),c=e("./documents/viewui.js"),u=e("./documents/searchui.js"),l=e("./config/charsequi.js"),d=e("./config/doctypeui.js"),f=function(){"use strict";return[s,r,a,d,l].forEach(function(e){var t=function(t){var n;window.clearTimeout(n),n=setTimeout(function(){8!==t.which&&46!==t.which&&e.get()},500)};document.addEventListener("keyup",function(n){n.target.id===e.prefix()+"-filter"?t(n):n.target.id===e.prefix()+"-limit"&&t(n)})}),$(document).on("keydown","#document-worksheets-form",function(e){return 13===e.which?(i.sender("worksheet-form-submit"),!1):!0}),$(document).on("keydown","#document-sets-form",function(e){return 13===e.which?(i.sender("sets-form-submit"),!1):!0}),$("#new-set-form").on("keydown",function(e){return 13===e.which?(i.sender("new-set-form-submit"),!1):!0}),$(document).bind("keydown","Alt+n",function(){var e=function(){return $("#edit-tabs")},t=e().find("li").length,n=e().tabs("option","active");return t-1>n?(e().tabs("option","active",n+1),i.sender("lost-focus")):(e().tabs("option","active",0),i.sender("lost-focus")),!1}),$(document).bind("keydown","Alt+c",function(){var e=$(document.activeElement).attr("id");return i.sender("initiated-command",e),!0}),$(document).bind("keydown","Alt+p",function(){var e=function(){return $("#edit-tabs")},t=e().find("li").length,n=e().tabs("option","active");return 0!==n?(e().tabs("option","active",n-1),i.sender("lost-focus")):(e().tabs("option","active",t-1),i.sender("lost-focus")),!1}),$(document).on("keydown","#edit-command-input",function(e){if(13===e.which){var t=$("#edit-command-input").val();i.sender("submitted-command",t)}return!0}),$(document).on("keydown","#edit-document-form input",function(e){return 13===e.which&&("none"===$("#save-document-button").css("display")?o.create():o.save()),!0}),$(document).on("keydown","#edit-document-form textarea","Alt+x",function(e){return o.toggleTextarea($(e.target)),!1}),$(document).on("keypress","#view-jump-id",function(e){if(13===e.which){var t=$("#view-jump-id").val();return c.get(t),!1}return!0}),$(document).on("keydown","#document-search-term",function(e){return 13===e.which?(u.getSearch(),!1):!0}),!0};n.keystrokes=f},{"./config/charsequi.js":10,"./config/doctypeui.js":15,"./documents/changeui.js":23,"./documents/editui.js":26,"./documents/indexui.js":28,"./documents/searchui.js":29,"./documents/viewui.js":31,"./index_tool/ipreviewui.js":43,"./jquery.hotkeys.js":47,"./sender.js":55}],49:[function(e,t,n){var i=e("templates.js"),s=e("./form.js"),r=function(e){"use strict";var t={};void 0===e.prefix&&(e.prefix="index");var n=e.format,r=e.prefix,a=function(e){return window.btoa(window.unescape(window.encodeURIComponent(JSON.stringify(e))))},o=function(){return document.getElementById(r+"-limit")};return t.get=function(n,i,c,u){var l=e.url+"?",d=e.indexId,f=1*o().value,b=e.target,p=document.getElementById(r+"-filter").value,h={sk:n,sid:i,pks:c,pids:u};return h.pks||(h.sk=a(p),h.pks=[],h.pids=[]),h.sk&&(l=l+"startkey="+window.escape(window.atob(h.sk)),h.sid&&(l=l+"&startkey_docid="+h.sid)),f?l=l+"&limit="+(f+1):(o().value=25,l+="&limit=26"),d&&(l=l+"&index="+d),s.send(l,!1,"GET",function(e,n){t.fill(n,h,b)},this),t},t.fill=function(e,s,c){var u,l,d,f=1*o().value,b=function(){return document.getElementById("previous-"+r+"-page")},p=function(){return document.getElementById("next-"+r+"-page")},h=function(){t.get(s.pks.pop(),s.pids.pop(),s.pks,s.pids)},v=function(){var e=document.getElementById("first-"+r+"-element"),n=p().getAttribute("data-startkey"),i=p().getAttribute("data-startid"),a=e.getAttribute("data-first-key"),o=e.getAttribute("data-first-id");s.pks.push(a),s.pids.push(o),t.get(n,i,s.pks,s.pids)};return u=void 0===n?JSON.parse(e.responseText):n(e.responseText),d=u.rows.map(function(e){return e.encoded_key=a(e.key),e}),l=d.slice(-1),d[0]&&(d[0].firstrow=!0),d.length>f?u.rows=d.slice(0,-1):(u.rows=d,u.lastpage=!0),u.lastrow=l,u.prefix=r,c.innerHTML=i["paged-listing"](u,{"listed-element":i.templates[r+"-element"]}),p().onclick=v,b().onclick=h,0===s.pks.length&&b().classList.add("hidden"),p().getAttribute("data-last-page")&&p().classList.add("hidden"),t},t};n.pager=r},{"./form.js":35,"templates.js":"e8H8MT"}],50:[function(e,t,n){var i=function(e){"use strict";var t;return t=$(e).attr("data-panel")?$("#"+$(e).attr("data-panel")):$(e).closest(".panel"),"none"===t.css("display")?t.css("display","table-cell"):t.css("display","none"),e};n.panelToggler=i},{}],51:[function(e,t,n){var i=e("./store.js").store,s=e("./form.js"),r=function(e,t,n){"use strict";var r,a={};r=t?t+"-":"",a.string=n?n+"/":"",a.category=t,a.origin=e,a.type=r+"path",a.valid_components=["doctype","fieldset","field"];var o=i(a.origin);return a.valid_components.forEach(function(e){a[e]=function(){var t=o.get(r+e);return t}()}),a.rev=o.get(r+"rev"),a.doctype=o.get(r+"doctype"),a.send=function(e,t,n,i){return s.send(""+a,e,t,n,i),a},a.put=function(e,t,n){return a.send(e,"PUT",t,n),a},a.post=function(e,t,n){return a.send(e,"POST",t,n),a},a.del=function(e,t){return a.send({},"DELETE",e,t),a},a.toString=function(){var e=a.string.concat(a.valid_components.map(function(e){var t=e+"s",n=a[e],i=null;return n?i=t+"/"+n:e===a.category&&(i=t),i}).filter(function(e){return"string"==typeof e&&!e.isBlank()}).join("/"));return a.rev&&(e=e.concat("?rev="+a.rev)),e},a};n.path=r},{"./form.js":35,"./store.js":58}],52:[function(e,t,n){var i,s=e("../form.js"),r=function(e){"use strict";window.confirm("Are you sure? This is permanent.")&&$.ajax({type:"DELETE",url:"/projects/"+e,dataType:"json",contentType:"application/json",complete:function(e){204===e.status?i():window.alert("An error occurred"+e.status)}})},a=function(){"use strict";var e=$("#project-name"),t=$("#project-description"),n=$(".validate-tips"),r=$([]).add(e).add(t),a=$("#add-dialog").dialog({autoOpen:!1,modal:!0,buttons:{"Add project":function(){r.removeClass("ui-state-error"),$(".validation-error-message").remove();var a=s.checkLength(e,"project name",1,50,n);a&&($.ajax({type:"POST",url:"projects/index",dataType:"json",contentType:"application/json",processData:!1,data:JSON.stringify({name:e.val(),description:t.val()}),complete:function(e){201===e.status?i():window.alert("An error occurred "+e.status)}}),$(this).dialog("close"))},Cancel:function(){$(this).dialog("close")}},close:function(){r.val("").removeClass("ui-state-error")}});return a},o=function(e){"use strict";var t=$(e).attr("id");return r(t),!0};i=function(){"use strict";var e="/projects/index";$.get(e,function(e){$("tbody").empty(),$("tbody").html(e)})},n.add=a,n.del=o,n.init=i},{"../form.js":35}],"templates.js":[function(e,t){t.exports=e("e8H8MT")},{}],54:[function(e,t,n){var i=function(e){"use strict";return e};(function(){"use strict";return Function.prototype.r=function(){return[this,arguments]},Function.prototype.t=function(){for(var e=[this,arguments],t=arguments[arguments.length-1];e[0]!==t;)e=e[0].apply(this,e[1]);return t.apply(this,e[1])},!0})(),n.identity=i},{}],55:[function(e,t,n){var i=e("./documents/commands.js"),s=e("./documents/documents.js"),r=e("./documents/editui.js"),a=e("./documents/searchui.js"),o=e("./documents/setsui.js"),c=e("./documents/worksheetui.js"),u=function(e,t){"use strict";var n;switch(e){case"bad-session-state":n=s.clearSession();break;case"doctype-info-ready":n=s.makeLabels();break;case"labels-ready":n=a.loadSearchVals(),c.buildTemplate();break;case"new-set-form-submit":n=o.saveSelected();break;case"sets-changed":n=o.updateSelection();break;case"sets-form-submit":n=o.performOp();break;case"session-cleared":s.setVersion(),n=s.loadDoctype();break;case"worksheet-form-submit":n=c.fillWorksheet();break;case"initiated-command":n=i.dialogOpen(t);break;case"executed-command":n=i.dialogClose();break;case"submitted-command":n=i.execute(t);break;case"lost-focus":n=r.selectInput()}return n};n.sender=u},{"./documents/commands.js":24,"./documents/documents.js":25,"./documents/editui.js":26,"./documents/searchui.js":29,"./documents/setsui.js":30,"./documents/worksheetui.js":32}],56:[function(e,t,n){var i=function(e){"use strict";return window.sessionStorage[e._id]||(window.sessionStorage[e._id]=JSON.stringify(e)),e._id},s=function(e){"use strict";var t=window.sessionStorage[e];return t?JSON.parse(t):null};n.put=i,n.get=s},{}],57:[function(e,t,n){var i=function(e,t){"use strict";var n=e.some(function(e){return t===e});return n},s=function(e,t){"use strict";t||(t=i);var n=e.reduce(function(e,n){return t(e,n)?e:e.concat([n])},[]);return n},r=function(e,t,n){"use strict";n||(n=i);var r=s(e.concat(t),n);return r},a=function(e,t,n){"use strict";n||(n=i);var s=e.filter(function(e){return n(t,e)});return s},o=function(e,t,n){"use strict";n||(n=i);var s=e.filter(function(e){return!n(t,e)});return s},c=function(e,t,n){"use strict";n||(n=i);var s=o(e,t,n),a=o(t,e,n),c=r(s,a,n);return c};n.member=i,n.unique=s,n.union=r,n.intersection=a,n.relativeComplement=o,n.symmetricDifference=c},{}],58:[function(e,t,n){var i=e("./utils.js"),s=e("./recurse.js"),r=function(e){"use strict";return e.replace(/-./,function(e){return e.toUpperCase()[1]})},a=function(e){"use strict";var t={};return void 0===e.dataset&&(e=e[0]),t.get=function(t){var n=r(t),i=e.dataset[n];if(i)return i;var a=function(e,t,n){var i=t.dataset.groupId,s=document.getElementById(i),r=s.dataset[e],o=s.dataset.groupId;return void 0===r&&void 0!==o&&i!==o?a.r(e,s,n):n.r(r)};return a.t(n,e,s.identity)},t.get64=function(e){var n=t.get(e);return n=i.Base64.decode(n.replace(/'/g,"")).replace(/(^'|'$)/g,"")},t.put=function(t,n){var i=r(t),s=e.dataset.groupId;document.getElementById(s).dataset[i]=n},t.fs=function(e){return t.get("fieldset-"+e)},t.f=function(e){return t.get("field-"+e)},t.d=function(e){return t.get("document-"+e)},t};n.store=a},{"./recurse.js":54,"./utils.js":59}],59:[function(e,t,n){var i=function(e){"use strict";return"string"!=typeof e||isNaN(e)||""===e?"":1*e},s=function(e){"use strict";return/^\s*$/.test(e)||null===e||void 0===e||"number"==typeof e&&isNaN(e)||"[object Array]"===Object.prototype.toString.call(e)&&0===e.length},r=function(e){"use strict";return!!e.match(/^[a-f0-9]{32}$/)},a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){"use strict";var t,n,i,s,r,o,c,u="",l=0;for(e=a._utf8_encode(e);e.length>l;)t=e.charCodeAt(l++),n=e.charCodeAt(l++),i=e.charCodeAt(l++),s=t>>2,r=(3&t)<<4|n>>4,o=(15&n)<<2|i>>6,c=63&i,isNaN(n)?o=c=64:isNaN(i)&&(c=64),u=u+this._keyStr.charAt(s)+this._keyStr.charAt(r)+this._keyStr.charAt(o)+this._keyStr.charAt(c);return u},decode:function(e){"use strict";var t,n,i,s,r,o,c,u="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");e.length>l;)s=this._keyStr.indexOf(e.charAt(l++)),r=this._keyStr.indexOf(e.charAt(l++)),o=this._keyStr.indexOf(e.charAt(l++)),c=this._keyStr.indexOf(e.charAt(l++)),t=s<<2|r>>4,n=(15&r)<<4|o>>2,i=(3&o)<<6|c,u+=String.fromCharCode(t),64!==o&&(u+=String.fromCharCode(n)),64!==c&&(u+=String.fromCharCode(i));return u=a._utf8_decode(u)},_utf8_encode:function(e){"use strict";e=e.replace(/\r\n/g,"\n");for(var t="",n=0;e.length>n;n++){var i=e.charCodeAt(n);128>i?t+=String.fromCharCode(i):i>127&&2048>i?(t+=String.fromCharCode(192|i>>6),t+=String.fromCharCode(128|63&i)):(t+=String.fromCharCode(224|i>>12),t+=String.fromCharCode(128|63&i>>6),t+=String.fromCharCode(128|63&i))}return t},_utf8_decode:function(e){"use strict";for(var t="",n=0,i=0,s=0,r=0;e.length>n;)i=e.charCodeAt(n),128>i?(t+=String.fromCharCode(i),n++):i>191&&224>i?(s=e.charCodeAt(n+1),t+=String.fromCharCode((31&i)<<6|63&s),n+=2):(s=e.charCodeAt(n+1),r=e.charCodeAt(n+2),t+=String.fromCharCode((15&i)<<12|(63&s)<<6|63&r),n+=3);return t}};n.stringToNumber=i,n.isBlank=s,n.validID=r,n.Base64=a},{}],e8H8MT:[function(e,t){var n=e("hogan.js"),i={"changelog-element":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.s(i.f("doc",e,t,1),e,t,0,8,777,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('<tr class="change-header" id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("  <th"),i.b("\n"+n),i.s(i.f("firstrow",e,t,1),e,t,0,73,188,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('      id="first-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-element"'),i.b("\n"+n),i.b('      data-first-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('      data-first-key="'),i.b(i.v(i.f("encoded_key",e,t,0))),i.b('"'),i.b("\n"+n),i.b("    ")}),e.pop()),i.b(">"),i.b("\n"+n),i.b("    <a"),i.b("\n"+n),i.b('      href="#'),i.b(i.v(i.f("document_id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('      class="view-document-link">'),i.b("\n"+n),i.b("      "),i.s(i.f("head_values",e,t,1),e,t,0,298,305,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b(n.v(n.d(".",e,t,0)))}),e.pop()),i.b("\n"+n),i.b("    </a>"),i.b("\n"+n),i.b("  </th>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("change_type",e,t,0))),i.b("\n"+n),i.b("  </td>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("user",e,t,0))),i.b("\n"+n),i.b("  </td>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("timestamp",e,t,0))),i.b("\n"+n),i.b("  </td>"),i.b("\n"+n),i.b("</tr>"),i.b("\n"+n),i.s(i.f("changes",e,t,1),e,t,0,459,764,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('  <tr class="change-change">'),i.b("\n"+n),i.b("    <th>"),i.b("\n"+n),i.b("      "),i.b(i.v(i.f("fieldsetLabel",e,t,0))),i.b(": "),i.b(i.v(i.f("fieldLabel",e,t,0))),i.b("\n"+n),i.b("    </th>"),i.b("\n"+n),i.b("    <td colspan=3>"),i.b("\n"+n),i.s(i.f("originalValue",e,t,1),e,t,1,0,0,"")||(i.b("      <b>Ø</b>"),i.b("\n")),i.b("      "),i.b(i.v(i.f("originalValue",e,t,0))),i.b("\n"+n),i.b("      →"),i.b("\n"+n),i.s(i.f("newValue",e,t,1),e,t,1,0,0,"")||(i.b("      <b>Ø</b>"),i.b("\n")),i.b("      "),i.b(i.v(i.f("newValue",e,t,0))),i.b("\n"+n),i.b("    </td>"),i.b("\n"+n),i.b("  </tr>"),i.b("\n")}),e.pop())}),e.pop()),i.fl()}),"charseqs-element":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<tr id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("  <th"),i.b("\n"+n),i.s(i.f("firstrow",e,t,1),e,t,0,42,157,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('      id="first-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-element"'),i.b("\n"+n),i.b('      data-first-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('      data-first-key="'),i.b(i.v(i.f("encoded_key",e,t,0))),i.b('"'),i.b("\n"+n),i.b("    ")}),e.pop()),i.b(">"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("key",e,t,0))),i.b("\n"+n),i.b("  </th>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("value",e,t,0))),i.b("\n"+n),i.b("   </td>"),i.b("\n"+n),i.b("</tr>"),i.b("\n"),i.fl()}),"config-maintenance":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div id="maintenance">'),i.b("\n"+n),i.b("  <h3>Upgrade Project</h3>"),i.b("\n"+n),i.b("\n"+n),i.b("  <p>"),i.b("\n"+n),i.b("    Clicking the button below will initiate an upgrade of the project"),i.b("\n"+n),i.b("    core design document to the latest version available on your"),i.b("\n"+n),i.b("    system."),i.b("\n"+n),i.b("  </p>"),i.b("\n"+n),i.b("  <p>"),i.b("\n"+n),i.b("    Be aware that this may cause significant slowness on your system"),i.b("\n"+n),i.b("    while view indexes are rebuilt."),i.b("\n"+n),i.b("  </p>"),i.b("\n"+n),i.b("\n"+n),i.b('  <a id="maintenance-upgrade-button" class="maintenance-upgrade-button link-button">Upgrade</a>'),i.b("\n"+n),i.b("</div>"),i.b("\n"),i.fl()}),"doctypes-element":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<tr id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("  <th"),i.b("\n"+n),i.s(i.f("firstrow",e,t,1),e,t,0,42,157,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('      id="first-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-element"'),i.b("\n"+n),i.b('      data-first-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('      data-first-key="'),i.b(i.v(i.f("encoded_key",e,t,0))),i.b('"'),i.b("\n"+n),i.b("    ")}),e.pop()),i.b(">"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("key",e,t,0))),i.b("\n"+n),i.b("  </th>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b("    "),i.b(i.v(i.f("value",e,t,0))),i.b("\n"+n),i.b("   </td>"),i.b("\n"+n),i.b("</tr>"),i.b("\n"),i.fl()}),"document-view-field":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<li "),i.b("\n"+n),i.b('  class="field-view '),i.b("\n"+n),i.b("    "),i.s(i.f("changed",e,t,1),e,t,0,42,49,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("changed")}),e.pop()),i.b('"'),i.b("\n"+n),i.b('  data-field-field="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.s(i.f("instance",e,t,1),e,t,0,108,150,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('  data-field-instance="'),n.b(n.v(n.f("instance",e,t,0))),n.b('"'),n.b("\n")}),e.pop()),i.b('  data-field-value="'),i.b(i.v(i.f("json_value",e,t,0))),i.b('">'),i.b("\n"+n),i.b("  <b>"),i.b(i.v(i.f("label",e,t,0))),i.b("</b>"),i.s(i.f("changed",e,t,1),e,t,0,235,343,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.s(n.f("newfield",e,t,1),e,t,1,0,0,"")||(n.b('<span class="small-control view-field-change" title="'),n.b(n.v(n.f("originalValue",e,t,0))),n.b('">→</span>'))}),e.pop()),i.b(":"),i.b("\n"+n),i.s(i.f("is_textarea",e,t,1),e,t,0,375,426,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('    <span class="retain-white">'),n.b(n.v(n.f("value",e,t,0))),n.b("</span>"),n.b("\n")}),e.pop()),i.s(i.f("is_textarea",e,t,1),e,t,1,0,0,"")||(i.b("    "),i.b(i.v(i.f("value",e,t,0))),i.b("\n")),i.b("</li>"),i.b("\n"),i.fl()}),"document-view-tree":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.s(i.f("previous_revision",e,t,1),e,t,0,22,76,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('  <div id="revision-message">Previous Revision</div>'),n.b("\n")}),e.pop()),i.b("\n"+n),i.s(i.f("deleted_",e,t,1),e,t,0,113,163,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('  <div id="deleted-message"><b>Deleted</b></div>'),n.b("\n")}),e.pop()),i.b("\n"+n),i.b("<ul>"),i.b("\n"+n),i.s(i.f("fieldsets",e,t,1),e,t,0,197,975,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("  <li"),i.b("\n"+n),i.b('    class="fieldset-view'),i.b("\n"+n),i.b("      "),i.s(i.f("collapse",e,t,1),e,t,0,248,257,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("collapsed")}),e.pop()),i.b("\n"+n),i.b("      "),i.s(i.f("altered",e,t,1),e,t,0,289,296,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("changed")}),e.pop()),i.b('"'),i.b("\n"+n),i.b('    data-fieldset-fieldset="'),i.b(i.v(i.f("id",e,t,0))),i.b('" '),i.b("\n"+n),i.b('    data-group-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("    <b>"),i.b(i.v(i.f("label",e,t,0))),i.b("</b>"),i.s(i.f("addition",e,t,1),e,t,0,414,468,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<span title="fieldset added" class="addition">+</span>')}),e.pop()),i.s(i.f("removal",e,t,1),e,t,0,493,548,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<span title="fieldset removed" class="removal">−</span>')}),e.pop()),i.b(":"),i.b("\n"+n),i.s(i.f("multiple",e,t,1),e,t,0,579,818,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("      <ol>"),i.b("\n"+n),i.s(i.f("multifields",e,t,1),e,t,0,613,785,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("        <li>"),i.b("\n"+n),i.b('          <ul class="multifield">'),i.b("\n"+n),i.s(i.f("fields",e,t,1),e,t,0,684,737,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b(n.rp("document-view-field",e,t,"              "))}),e.pop()),i.b("          </ul>"),i.b("\n"+n),i.b("        </li>"),i.b("\n")}),e.pop()),i.b("      </ol>"),i.b("\n")}),e.pop()),i.s(i.f("multiple",e,t,1),e,t,1,0,0,"")||(i.b("      <ul>"),i.b("\n"+n),i.s(i.f("fields",e,t,1),e,t,0,880,925,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b(n.rp("document-view-field",e,t,"          "))}),e.pop()),i.b("      </ul>"),i.b("\n")),i.b("  </li>"),i.b("\n")}),e.pop()),i.b("</ul>"),i.b("\n"+n),i.b("\n"+n),i.b('<div class="timestamps">'),i.b("\n"+n),i.b("  <dl>"),i.b("\n"+n),i.b('    <dt>Created At</dt><dd class="timestamp">'),i.b(i.v(i.f("created_at_",e,t,0))),i.b("</dd>"),i.b("\n"+n),i.b("    <dt>Created By</dt><dd>"),i.b(i.v(i.f("created_by_",e,t,0))),i.b("</dd>"),i.b("\n"+n),i.b('    <dt>Updated At</dt><dd class="timestamp">'),i.b(i.v(i.f("updated_at_",e,t,0))),i.b("</dd>"),i.b("\n"+n),i.b("    <dt>Updated By</dt><dd>"),i.b(i.v(i.f("updated_by_",e,t,0))),i.b("</dd>"),i.b("\n"+n),i.b("    <dt>ID</dt><dd>"),i.b(i.v(i.f("_id",e,t,0))),i.b("</dd>"),i.b("\n"+n),i.b("  </dl>"),i.b("\n"+n),i.b("</div>"),i.b("\n"),i.fl()}),"document-view":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.s(i.f("doctype_info",e,t,1),e,t,0,17,197,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('  <h2 class="header">'),i.b(i.v(i.f("_id",e,t,0))),i.b(" View</h2>"),i.b("\n"+n),i.b("\n"+n),i.b('  <form id="view-jump">'),i.b("\n"+n),i.b('    <label for="view-jump-id">Id</label>'),i.b("\n"+n),i.b('    <input type="text" id="view-jump-id" name="view-jump-id">'),i.b("\n"+n),i.b("  </form>"),i.b("\n")}),e.pop()),i.b("\n"+n),i.b('<div id="document-view-info"'),i.b("\n"+n),i.b('     data-document-deleted="'),i.b(i.v(i.f("deleted_",e,t,0))),i.b('"'),i.b("\n"+n),i.b('     data-document-document="'),i.b(i.v(i.f("_id",e,t,0))),i.b('" '),i.b("\n"+n),i.b('     data-document-rev="'),i.b(i.v(i.f("_rev",e,t,0))),i.b('"></div>'),i.b("\n"+n),i.b("\n"+n),i.b('<a id="document-restore-button"'),i.b("\n"+n),i.b('   data-group-id="document-view-info"'),i.b("\n"+n),i.b('   class="link-button hidden">Restore</a>'),i.b("\n"+n),i.b("\n"+n),i.b('<a id="document-edit-button"'),i.b("\n"+n),i.b('   data-group-id="document-view-info"'),i.b("\n"+n),i.b('   class="link-button">Edit</a>'),i.b("\n"+n),i.b("\n"+n),i.b('<a id="document-delete-button"'),i.b("\n"+n),i.b('   data-group-id="document-view-info"'),i.b("\n"+n),i.b('   class="link-button">Delete</a>'),i.b("\n"+n),i.b("\n"+n),i.b('<nav id="history">'),i.b("\n"+n),i.s(i.f("revs_info",e,t,1),e,t,0,726,1001,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.s(i.f("status",e,t,1),e,t,0,742,985,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('      <a href="#'),i.b(i.v(i.f("_id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('         class="revision-link"'),i.b("\n"+n),i.b('         data-group-id="document-view-info"'),i.b("\n"+n),i.s(i.f("first",e,t,1),e,t,0,864,910,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('         id="current-revision-link"'),n.b("\n")
}),e.pop()),i.b('         data-document-oldrev="'),i.b(i.v(i.f("rev",e,t,0))),i.b('">'),i.b(i.v(i.f("count",e,t,0))),i.b("</a>"),i.b("\n")}),e.pop())}),e.pop()),i.b("</nav>"),i.b("\n"+n),i.b("\n"+n),i.b('<div id="document-view-tree">'),i.b("\n"+n),i.b(i.rp("document-view-tree",e,t,"  ")),i.b("</div>"),i.b("\n"),i.fl()}),"index-element":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<tr class="change-header" id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("  <th"),i.b("\n"+n),i.s(i.f("firstrow",e,t,1),e,t,0,64,179,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('      id="first-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-element"'),i.b("\n"+n),i.b('      data-first-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('      data-first-key="'),i.b(i.v(i.f("encoded_key",e,t,0))),i.b('"'),i.b("\n"+n),i.b("    ")}),e.pop()),i.b(">"),i.b("\n"+n),i.b('    <ul class="head-elements">'),i.b("\n"+n),i.s(i.f("display_key",e,t,1),e,t,0,247,362,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("        <li>"),i.b("\n"+n),i.b('          <a href="#'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('            class="view-document-link">'),i.b(i.v(i.d(".",e,t,0))),i.b("</a>"),i.b("\n"+n),i.b("        </li>"),i.b("\n")}),e.pop()),i.b("    </ul>"),i.b("\n"+n),i.b("  </th>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b('    <ul class="reversal-elements">'),i.b("\n"+n),i.s(i.f("value",e,t,1),e,t,0,455,487,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("        <li>"),n.b(n.v(n.d(".",e,t,0))),n.b("</li>"),n.b("\n")}),e.pop()),i.b("    </ul>"),i.b("\n"+n),i.b("  </td>"),i.b("\n"+n),i.b("</tr>"),i.b("\n"),i.fl()}),"index-listing":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<table>"),i.b("\n"+n),i.b("  <thead>"),i.b("\n"+n),i.b("    <th>Name</th>"),i.b("\n"+n),i.b("    <th>Doctype</th>"),i.b("\n"+n),i.b("  </thead>"),i.b("\n"+n),i.b("  <tbody>"),i.b("\n"+n),i.s(i.f("rows",e,t,1),e,t,0,91,210,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("    <tr>"),i.b("\n"+n),i.b('      <th><a href="#" data-index-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b(i.v(i.d("key.1",e,t,0))),i.b("</a></th> "),i.b("\n"+n),i.b("      <td>"),i.b(i.v(i.d("key.0",e,t,0))),i.b("</td>"),i.b("\n"+n),i.b("    </tr>"),i.b("\n")}),e.pop()),i.b("  </tbody>"),i.b("\n"+n),i.b("</table>"),i.fl()}),"index-options":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<option></option>"),i.b("\n"+n),i.s(i.f("rows",e,t,1),e,t,0,27,74,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<option value="'),n.b(n.v(n.f("id",e,t,0))),n.b('">'),n.b(n.v(n.d("key.1",e,t,0))),n.b("</option>"),n.b("\n")}),e.pop()),i.fl()}),"paged-listing":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<nav class="pager">'),i.b("\n"+n),i.b("<a"),i.b("\n"+n),i.b('  href="#" '),i.b("\n"+n),i.b('  title="Previous Page"'),i.b("\n"+n),i.b('  id="previous-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-page"'),i.b("\n"+n),i.b('  class="pager-button link-button"'),i.b("\n"+n),i.b(">Prev</a> "),i.b("\n"+n),i.b("<a"),i.b("\n"+n),i.b('  href="#"'),i.b("\n"+n),i.b('  title="Next Page"'),i.b("\n"+n),i.b('  class="pager-button link-button"'),i.b("\n"+n),i.b('  id="next-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-page"'),i.b("\n"+n),i.s(i.f("lastpage",e,t,1),e,t,0,322,351,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('    data-last-page="true"'),n.b("\n")}),e.pop()),i.s(i.f("lastrow",e,t,1),e,t,0,379,448,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('    data-startkey="'),i.b(i.v(i.f("encoded_key",e,t,0))),i.b('"'),i.b("\n"+n),i.b('    data-startid="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n")}),e.pop()),i.b(">Next</a>"),i.b("\n"+n),i.b("</nav>"),i.b("\n"+n),i.b('<div class="total-rows-info">'),i.b("\n"+n),i.b("  <b>Total</b>: "),i.b(i.v(i.f("total_rows",e,t,0))),i.b("\n"+n),i.b("</div>"),i.b("\n"+n),i.b("<table>"),i.b("\n"+n),i.s(i.f("rows",e,t,1),e,t,0,567,595,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b(n.rp("listed-element",e,t,"    "))}),e.pop()),i.b("</table>"),i.b("\n"),i.fl()}),"preview-element":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<tr class="change-header" id="'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("  <th"),i.b("\n"+n),i.s(i.f("firstrow",e,t,1),e,t,0,64,179,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('      id="first-'),i.b(i.v(i.f("prefix",e,t,0))),i.b('-element"'),i.b("\n"+n),i.b('      data-first-id="'),i.b(i.v(i.f("id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('      data-first-key="'),i.b(i.v(i.f("encoded_key",e,t,0))),i.b('"'),i.b("\n"+n),i.b("    ")}),e.pop()),i.b(">"),i.b("\n"+n),i.b('    <ul class="head-elements">'),i.b("\n"+n),i.s(i.f("display_key",e,t,1),e,t,0,247,279,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("        <li>"),n.b(n.v(n.d(".",e,t,0))),n.b("</li>"),n.b("\n")}),e.pop()),i.b("    </ul>"),i.b("\n"+n),i.b("  </th>"),i.b("\n"+n),i.b("  <td>"),i.b("\n"+n),i.b('    <ul class="reversal-elements">'),i.b("\n"+n),i.b("      "),i.b(i.v(i.f("value",e,t,0))),i.b("\n"+n),i.b("    </ul>"),i.b("\n"+n),i.b("  </td>"),i.b("\n"+n),i.b("</tr>"),i.b("\n"),i.fl()}),"search-field-item":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<a class='search-field-item' "),i.b("\n"+n),i.b("  title='click to remove' "),i.b("\n"+n),i.b("  data-field-field='"),i.b(i.v(i.f("field",e,t,0))),i.b("' "),i.b("\n"+n),i.b("  href='#'>"),i.b(i.v(i.f("fieldLabel",e,t,0))),i.b("</a>"),i.b("\n"),i.fl()}),"set-listing":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<div class="total-rows-info">'),i.b("\n"+n),i.b('  <b>Total</b>: <span id="total-set-rows">'),i.b(i.v(i.f("total",e,t,0))),i.b("</span>"),i.b("\n"+n),i.b("</div>"),i.b("\n"+n),i.b('<div id="save-set-results">'),i.b("\n"+n),i.b('  <a href="#">(Save Selected)</a>'),i.b("\n"+n),i.b("</div>"),i.b("\n"+n),i.b('<table id="set-elements">'),i.b("\n"+n),i.b("  <thead>"),i.b("\n"+n),i.b("    <tr>"),i.b("\n"+n),i.b("      <td>"),i.b("\n"+n),i.b('        <input type="checkbox" id="select-all-set-elements" title="Click to select or deselect all elements" />'),i.b("\n"+n),i.b("      </td>"),i.b("\n"+n),i.b("      <th>"),i.b("\n"+n),i.b("        Elements"),i.b("\n"+n),i.b("      </th>"),i.b("\n"+n),i.b("    </tr>"),i.b("\n"+n),i.b("  </thead>"),i.b("\n"+n),i.b("  <tbody>"),i.b("\n"+n),i.s(i.f("elements",e,t,1),e,t,0,435,674,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("    <tr>"),i.b("\n"+n),i.b("      <td>"),i.b("\n"+n),i.b('        <input type="checkbox" class="set-element-selection" title="Click to select element" />'),i.b("\n"+n),i.b("      </td>"),i.b("\n"+n),i.b("      <td>"),i.b("\n"+n),i.b('        <a class="view-document-link" href="#'),i.b(i.v(i.f("id",e,t,0))),i.b('">'),i.b(i.v(i.f("context",e,t,0))),i.b("</a>"),i.b("\n"+n),i.b("      </td>"),i.b("\n"+n),i.b("    </tr>"),i.b("\n")}),e.pop()),i.b("  </tbody>"),i.b("\n"+n),i.b("</table>"),i.b("\n"),i.fl()}),"set-options":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<option></option>"),i.b("\n"+n),i.s(i.f("names",e,t,1),e,t,0,28,66,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('<option value="'),n.b(n.v(n.d(".",e,t,0))),n.b('">'),n.b(n.v(n.d(".",e,t,0))),n.b("</option>"),n.b("\n")}),e.pop()),i.fl()}),"simple-to-form-field":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<li>"),i.b("\n"+n),i.b('  <label for="'),i.b(i.v(i.f("key",e,t,0))),i.b('">'),i.b(i.v(i.f("key",e,t,0))),i.b("</label>"),i.b("\n"+n),i.s(i.f("text",e,t,1),e,t,1,0,0,"")||(i.b('  <input type="'),i.s(i.f("string",e,t,1),e,t,0,86,90,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("text")}),e.pop()),i.s(i.f("number",e,t,1),e,t,0,112,118,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("number")}),e.pop()),i.b('" name="'),i.b(i.v(i.f("key",e,t,0))),i.b('" value="'),i.b(i.v(i.f("val",e,t,0))),i.b('"/>'),i.b("\n")),i.s(i.f("text",e,t,1),e,t,0,191,246,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b('    <textarea name="'),n.b(n.v(n.f("key",e,t,0))),n.b('">'),n.b(n.v(n.f("val",e,t,0))),n.b("</textarea>"),n.b("\n")}),e.pop()),i.b("</li>"),i.b("\n"),i.fl()}),"simple-to-form":new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b("<form>"),i.b("\n"+n),i.b("  <ul>"),i.b("\n"+n),i.s(i.f("fields",e,t,1),e,t,0,29,67,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b(n.rp("simple-to-form-field",e,t,"      "))}),e.pop()),i.b("  </ul>"),i.b("\n"+n),i.b("</form>"),i.b("\n"),i.fl()}),worksheet:new n.Template(function(e,t,n){var i=this;return i.b(n=n||""),i.b('<table id="worksheet-table">'),i.b("\n"+n),i.b("  <thead>"),i.b("\n"+n),i.b('    <tr class="header-row">'),i.b("\n"+n),i.b('      <td id="select-all-worksheet-rows-cell"'),i.b("\n"+n),i.b('        class="select-column">'),i.b("\n"+n),i.b("        <input "),i.b("\n"+n),i.b('          id="select-all-worksheet-rows"'),i.b("\n"+n),i.b('          type="checkbox"'),i.b("\n"+n),i.b('          title="Click to select all rows">'),i.b("\n"+n),i.b("      </td>"),i.b("\n"+n),i.s(i.f("fieldsets",e,t,1),e,t,0,303,1494,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("        <th "),i.b("\n"+n),i.b('          class="worksheet-handle-header fieldset handle-column '),i.b(i.v(i.f("_id",e,t,0))),i.b('"'),i.b("\n"+n),i.b('          title="'),i.b(i.v(i.f("label",e,t,0))),i.b('">'),i.b("\n"+n),i.b("          <div>"),i.b("\n"+n),i.b("            <span>"),i.b("\n"+n),i.b('              <a class="fieldset-handle" '),i.b("\n"+n),i.b('                data-field-fieldset="'),i.b(i.v(i.f("_id",e,t,0))),i.b('" '),i.b("\n"+n),i.b('                href="#">'),i.b(i.v(i.f("label",e,t,0))),i.b("</a></span></div>"),i.b("\n"+n),i.b("        </th>"),i.b("\n"+n),i.s(i.f("fields",e,t,1),e,t,0,634,1476,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b("          <th"),i.b("\n"+n),i.b('            class="'),i.s(i.f("multiple",e,t,1),e,t,0,681,689,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("multiple")}),e.pop()),i.b(" "),i.s(i.f("collapse",e,t,1),e,t,0,716,724,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("collapse")}),e.pop()),i.b(" "),i.b(i.v(i.f("fieldset",e,t,0))),i.b(" "),i.b(i.v(i.f("_id",e,t,0))),i.b(' worksheet-handle-header field handle-column"'),i.b("\n"+n),i.b('            title="'),i.b(i.v(i.f("label",e,t,0))),i.b('">'),i.b("\n"+n),i.b("            <div>"),i.b("\n"+n),i.b("              <span>"),i.b("\n"+n),i.b('                <a class="field-handle" '),i.b("\n"+n),i.b('                  data-field-field="'),i.b(i.v(i.f("_id",e,t,0))),i.b('" '),i.b("\n"+n),i.b('                  href="#">'),i.b(i.v(i.f("label",e,t,0))),i.b("</a></span></div>"),i.b("\n"+n),i.b("          </th>"),i.b("\n"+n),i.b("          <th"),i.b("\n"+n),i.b('            class="'),i.b(i.v(i.f("fieldset",e,t,0))),i.b(" "),i.b(i.v(i.f("_id",e,t,0))),i.b(' field-column"'),i.b("\n"+n),i.b('            title="'),i.b(i.v(i.f("label",e,t,0))),i.b('">'),i.b("\n"+n),i.b('            <a class="field-header" '),i.b("\n"+n),i.b('              data-field-field="'),i.b(i.v(i.f("_id",e,t,0))),i.b('" '),i.b("\n"+n),i.b('              href="#">'),i.b(i.v(i.f("label",e,t,0))),i.b("</a>"),i.b("\n"+n),i.b("            <input "),i.b("\n"+n),i.b('              class="select-worksheet-column"'),i.b("\n"+n),i.b('              data-field-field="'),i.b(i.v(i.f("_id",e,t,0))),i.b('" '),i.b("\n"+n),i.b('              type="checkbox"'),i.b("\n"+n),i.b('              title="Click to select column">'),i.b("\n"+n),i.b("          </td>"),i.b("\n")}),e.pop())}),e.pop()),i.b("    </tr>"),i.b("\n"+n),i.b("  </thead>"),i.b("\n"+n),i.b("  <tbody>"),i.b("\n"+n),i.b("    <%#rows%>"),i.b("\n"+n),i.b('      <tr id="worksheet-row-<% _id %>"'),i.b("\n"+n),i.b('        class="body-row">'),i.b("\n"+n),i.b('        <td class="select-column">'),i.b("\n"+n),i.b("          <input "),i.b("\n"+n),i.b('            class="select-worksheet-row"'),i.b("\n"+n),i.b('            data-row="worksheet-row-<% _id %>"'),i.b("\n"+n),i.b('            type="checkbox"'),i.b("\n"+n),i.b('            title="Click to select row">'),i.b("\n"+n),i.b("        </td>"),i.b("\n"+n),i.s(i.f("fieldsets",e,t,1),e,t,0,1865,2890,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('          <td class="'),i.b(i.v(i.f("_id",e,t,0))),i.b(' fieldset handle-column"></td>'),i.b("\n"+n),i.s(i.f("fields",e,t,1),e,t,0,1948,2870,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('            <td class="'),i.s(i.f("multiple",e,t,1),e,t,0,1985,1993,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("multiple")}),e.pop()),i.b(" "),i.s(i.f("collapse",e,t,1),e,t,0,2020,2028,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("collapse")}),e.pop()),i.b(" "),i.b(i.v(i.f("_id",e,t,0))),i.b(" "),i.b(i.v(i.f("fieldset",e,t,0))),i.b(' field handle-column"></td>'),i.b("\n"+n),i.b("            <td"),i.b("\n"+n),i.b('              class="'),i.s(i.f("multiple",e,t,1),e,t,0,2144,2152,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("multiple")}),e.pop()),i.b(" "),i.s(i.f("collapse",e,t,1),e,t,0,2179,2187,"{{ }}")&&(i.rs(e,t,function(e,t,n){n.b("collapse")}),e.pop()),i.b(" "),i.b(i.v(i.f("fieldset",e,t,0))),i.b(" "),i.b(i.v(i.f("_id",e,t,0))),i.b(' field-column"'),i.b("\n"+n),i.b('              data-field-fieldset="'),i.b(i.v(i.f("fieldset",e,t,0))),i.b('"'),i.b("\n"+n),i.b('              data-field-field="'),i.b(i.v(i.f("_id",e,t,0))),i.b('">'),i.b("\n"+n),i.b("              <%#"),i.b(i.v(i.f("_id",e,t,0))),i.b("%>"),i.b("\n"+n),i.b("                <%#multiple%>"),i.b("\n"+n),i.b("                <ol>"),i.b("\n"+n),i.b("                  <%#items%>"),i.b("\n"+n),i.b("                    <li"),i.b("\n"+n),i.b('                      data-field-fieldset_instance="<% fieldset_instance %>"'),i.b("\n"+n),i.b('                      data-field-field_instance="<% field_instance %>"><% value %></li>'),i.b("\n"+n),i.b("                  <%/items%>"),i.b("\n"+n),i.b("                </ol>"),i.b("\n"+n),i.b("                <%/multiple%>"),i.b("\n"+n),i.b("                <%#single%>"),i.b("\n"+n),i.b("                  <span><% value %></span>"),i.b("\n"+n),i.b("                <%/single%>"),i.b("\n"+n),i.b("              <%/"),i.b(i.v(i.f("_id",e,t,0))),i.b("%>"),i.b("\n"+n),i.b("            </td>"),i.b("\n")}),e.pop())}),e.pop()),i.b("      </tr>"),i.b("\n"+n),i.b("    <%/rows%>"),i.b("\n"+n),i.b("  </tbody>"),i.b("\n"+n),i.b("</table>"),i.b("\n"),i.fl()})},s=function(e){var t=i[e];return function(e,n,s){return t.render(e,n||i,s)}};t.exports={templates:i,"changelog-element":s("changelog-element"),"charseqs-element":s("charseqs-element"),"config-maintenance":s("config-maintenance"),"doctypes-element":s("doctypes-element"),"document-view-field":s("document-view-field"),"document-view-tree":s("document-view-tree"),"document-view":s("document-view"),"index-element":s("index-element"),"index-listing":s("index-listing"),"index-options":s("index-options"),"paged-listing":s("paged-listing"),"preview-element":s("preview-element"),"search-field-item":s("search-field-item"),"set-listing":s("set-listing"),"set-options":s("set-options"),"simple-to-form-field":s("simple-to-form-field"),"simple-to-form":s("simple-to-form"),worksheet:s("worksheet")}},{"hogan.js":2}]},{},[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,54,55,56,57,58,59]);